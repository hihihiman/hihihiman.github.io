<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Distributed Transaction - 分布式事务 -</title><meta name=author content="都将会"><meta name=author-link content><meta name=description content="“”"><meta name=keywords content="Distributed,interview,面试,Transaction"><meta itemprop=name content="Distributed Transaction - 分布式事务"><meta itemprop=description content="“”"><meta itemprop=datePublished content="2022-11-08T08:08:08+08:00"><meta itemprop=dateModified content="2022-11-08T08:08:08+08:00"><meta itemprop=wordCount content="4044"><meta itemprop=image content="https://leni.fun/images/avatar.jpg"><meta itemprop=keywords content="Distributed,"><meta property="og:title" content="Distributed Transaction - 分布式事务"><meta property="og:description" content="“”"><meta property="og:type" content="article"><meta property="og:url" content="https://leni.fun/distributed-transaction/"><meta property="og:image" content="https://leni.fun/images/avatar.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-08T08:08:08+08:00"><meta property="article:modified_time" content="2022-11-08T08:08:08+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://leni.fun/images/avatar.jpg"><meta name=twitter:title content="Distributed Transaction - 分布式事务"><meta name=twitter:description content="“”"><meta name=application-name content="都将会的 APP"><meta name=apple-mobile-web-app-title content="都将会的 APP"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://leni.fun/distributed-transaction/><link rel=prev href=https://leni.fun/netty_note/><link rel=next href=https://leni.fun/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Distributed Transaction - 分布式事务","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/leni.fun\/distributed-transaction\/"},"genre":"posts","keywords":"Distributed","wordcount":4044,"url":"https:\/\/leni.fun\/distributed-transaction\/","datePublished":"2022-11-08T08:08:08+08:00","dateModified":"2022-11-08T08:08:08+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"都将会"},"description":"“”"}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title><img loading=lazy src=/images/icon.png srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x" sizes=auto data-title=/images/icon.png data-alt=/images/icon.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>都将会</span></a><span id=typeit-header-subtitle-desktop class="typeit header-subtitle"></span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 技术</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/life/><i class="fa-solid fa-camera-alt fa-fw fa-sm" aria-hidden=true></i> 生活</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=关键词搜索 id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title><img loading=lazy src=/images/icon.png srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x" sizes=auto data-title=/images/icon.png data-alt=/images/icon.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>都将会</span></a><span id=typeit-header-subtitle-mobile class="typeit header-subtitle"></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=关键词搜索 id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 技术</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/life/><i class="fa-solid fa-camera-alt fa-fw fa-sm" aria-hidden=true></i> 生活</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/ title>主页</a></li><li class=breadcrumb-item><a href=/posts/ title=Posts>Posts</a></li><li class="breadcrumb-item active" aria-current=page>Distributed Transaction - 分布式事务</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Distributed Transaction - 分布式事务</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/images/avatar.jpg srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes=auto data-title=都将会 data-alt=都将会 class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;都将会</span></span>
<span class=post-category>收录于 <a href=/categories/draft/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> draft</a></span></div><div class=post-meta-line><span title="发布于 2022-11-08 08:08:08"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2022-11-08>2022-11-08</time></span>&nbsp;<span title="更新于 2022-11-08 08:08:08"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2022-11-08>2022-11-08</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 4044 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 9 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="Distributed Transaction - 分布式事务">
<i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#1-3pc-相比-2pc-改进在哪>1. 3PC 相比 2PC 改进在哪？</a></li><li><a href=#2-tcc-与-2pc3pc-的区别>2. TCC 与 2PC/3PC 的区别？</a></li><li><a href=#3-分布式事务分类柔性事务和刚性事务>3. 分布式事务分类：柔性事务和刚性事务</a><ul><li><a href=#最努通知事务-vs-异步确保型事务>最⼤努⼒通知事务 VS 异步确保型事务</a></li></ul></li><li><a href=#4-刚性事务---xa-模型>4. 刚性事务 - XA 模型</a></li><li><a href=#5-xa规范>5. XA规范</a></li><li><a href=#6-jta规范>6. JTA规范</a></li><li><a href=#7-tcc>7. TCC</a><ul><li><a href=#try-阶段失败可以-cancel如果-confirm-和-cancel-阶段失败了怎么办>Try 阶段失败可以 Cancel，如果 Confirm 和 Cancel 阶段失败了怎么办？</a></li><li><a href=#tcc事务模型的要求>TCC事务模型的要求</a></li><li><a href=#tcc事务模型-vs-dtp事务模型>TCC事务模型 VS DTP事务模型</a></li><li><a href=#tcc与2pc对>TCC与2PC对⽐</a></li><li><a href=#tcc-的使场景>TCC 的使⽤场景</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h3 id=1-3pc-相比-2pc-改进在哪>1. 3PC 相比 2PC 改进在哪？</h3><p>3PC在事务管理者和事务参与者中引入了超时机制，超过响应时间默认失败，以避免事务参与者一直阻塞占用资源。（性能下降）在2PC中直邮事务管理者才拥有超时机制。
实际应用广泛的：2PC+复制状态机</p><h3 id=2-tcc-与-2pc3pc-的区别>2. TCC 与 2PC/3PC 的区别？</h3><p>TCC ：Try - Confirm - Cancel，一种柔性事务解决方案</p><ul><li>2PC/3PC 依靠<strong>数据库</strong>或者存储资源层面的事务，TCC 主要通过修改<strong>业务代码</strong>来实现。</li><li>2PC/3PC 属于业务<strong>代码无侵入</strong>的，TCC <strong>对业务代码有侵入</strong>。</li><li>2PC/3PC 追求的是<strong>强一致性</strong>，在两阶段提交的整个过程中，一直会持有数据库的锁。TCC 追求的</li></ul><p>是<strong>最终一致性</strong>，不会一直持有各个业务资源的锁。</p><h3 id=3-分布式事务分类柔性事务和刚性事务>3. 分布式事务分类：柔性事务和刚性事务</h3><ul><li>柔性事务：TCC/FMT、Saga（状态机模式、Aop模式）、本地事务消息、消息事务（半消息）<ul><li>满足 BASE 理论</li><li>有业务改造，最终⼀致性，实现补偿接⼝，实现资源锁定接⼝，⾼并发，适合⻓事务</li><li>细分为两种：<ul><li>补偿型事务（同步）：TCC、Saga<ul><li>TCC 把事务运⾏过程分成 Try、Confirm / Cancel 两个阶段，每个阶段的逻辑由业务代码控制，避免了⻓事务，可以获取更⾼的性能。</li></ul></li><li>通知型事务（异步）：MQ事务消息、最⼤努⼒通知型。<ul><li>外部系统：最大努力通知型因为外部的⽹络环境更加复杂和不可信，所以只能尽最⼤努⼒去通知实现数据最终⼀致性，⽐如充值平台与运营商、⽀付对接等等跨⽹络系统级别对接；</li><li>内部系统：异步确保型，因为内部相对⽐较可控，如订单和购物⻋、收货与清算、⽀付与结算等等场景；</li></ul></li></ul></li></ul></li><li>刚性事务：XA 协议（2PC、JTA、JTS）、3PC<ul><li>满足 CP 理论</li><li>通常⽆业务改造，强⼀致性，原⽣⽀持回滚/隔离性，低并发，适合短事务</li><li>但由于同步阻塞，处理效率低，不适合⼤型⽹站分布式场景</li></ul></li></ul><h4 id=最努通知事务-vs-异步确保型事务>最⼤努⼒通知事务 VS 异步确保型事务</h4><p>最⼤努⼒通知事务在我认知中，其实是基于异步确保型事务发展⽽来适⽤于外部对接的⼀种业务实现。他们主要有的是业务差别，如下：</p><ul><li>从参与者来说：最⼤努⼒通知事务适⽤于跨平台、跨企业的系统间业务交互；异步确保型事务更适⽤于同⽹络体系的内部服务交付。</li><li>从消息层⾯说：最⼤努⼒通知事务需要主动推送并提供多档次时间的重试机制来保证数据的通知；⽽异步确保型事务只需要消息消费者主动去消费。</li><li>从数据层⾯说：最⼤努⼒通知事务还需额外的定期校验机制对数据进⾏兜底，保证数据的最终⼀致性；⽽异步确保型事务只需保证消息的可靠投递即可，⾃身⽆需对数据进⾏兜底处理。</li></ul><h3 id=4-刚性事务---xa-模型>4. 刚性事务 - XA 模型</h3><p>这个模型主要使⽤了 <strong>2PC</strong> 来保证分布式事务的完整性。
在X/Open **DTP(Distributed Transaction Process)**模型⾥⾯，有三个⻆⾊：</p><ul><li>AP: Application，应⽤程序。也就是业务层。哪些操作属于⼀个事务，就是AP定义的。</li><li>TM: Transaction Manager，事务管理器。接收AP的事务请求，对全局事务进⾏管理，管理事务分⽀状态，协调RM的处理，通知RM哪些操作属于哪些全局事务以及事务分⽀等等。这个也是整个事务调度模型的核⼼部分。</li><li>RM：Resource Manager，资源管理器。⼀般是数据库，也可以是其他的资源管理器，如消息队列(如JMS数据源)，⽂件系统等。</li></ul><p><a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/78dda715a3df85e2b46f0d0827023d33.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><p>XA规范主要定义了(全局)事务管理器(Transaction Manager)和(局部)资源管理器(Resource Manager)之间的接⼝。XA接⼝是双向的系统接⼝，在事务管理器（Transaction Manager）以及⼀个或多个资源管理器（Resource
Manager）之间形成通信桥梁，从⽽在多个数据库资源下保证ACID四个特性。⽬前知名的数据库，如Oracle, DB2,mysql等，都是实现了XA接⼝的，都可以作为RM。
XA之所以需要引⼊事务管理器是因为，在分布式系统中，从理论上讲（参考Fischer等的论⽂），两台机器理论上⽆法达到⼀致的状态，需要引⼊⼀个单点进⾏协调。事务管理器控制着全局事务，管理事务⽣命周期，并协调资源。资源管理器负责控制和管理实际资源（如<a href=http://lib.csdn.net/base/mysql target=_blank rel="external nofollow noopener noreferrer">数据库</a>或JMS队列)
<a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7a671a2e60890f26ab883dce295bc692.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><h3 id=5-xa规范>5. XA规范</h3><p><strong>以下的函数使事务管理器可以对资源管理器进⾏的操作</strong>：</p><ol><li>xa_open,xa_close：建⽴和关闭与资源管理器的连接。</li><li>xa_start,xa_end：开始和结束⼀个本地事务。</li><li>xa_prepare,xa_commit,xa_rollback：预提交、提交和回滚⼀个本地事务。</li><li>xa_recover：回滚⼀个已进⾏预提交的事务。</li><li>ax_开头的函数使资源管理器可以动态地在事务管理器中进⾏注册，并</li></ol><p>可以对XID(TRANSACTION IDS)进⾏操作。</p><ol><li>ax_reg,ax_unreg；允许⼀个资源管理器在⼀个TMS(TRANSACTION</li></ol><p>MANAGER SERVER)中动态注册或撤消注册。
<strong>XA各个阶段的处理流程</strong>
<a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/7dd02ccf1353eb383a953d35aa099d27.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><p><a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/a3671dda53200a8cd10ff6e0f884f7b6.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><h3 id=6-jta规范>6. JTA规范</h3><p>作为java平台上事务规范 JTA（Java Transaction API）也定义了对XA事务的⽀持，实际上，JTA是基于XA架构上建模的，在JTA 中，事务管理器抽象为<code>javax.transaction.TransactionManager</code>接⼝，并通过底层事务服务
（即JTS）实现。像很多其他的java规范⼀样，JTA仅仅定义了接⼝，具体的实现则是由供应商(如J2EE⼚商)负责提供。</p><h3 id=7-tcc>7. TCC</h3><p>TCC(Try-Confirm-Cancel)分布式事务模型相对于 XA 等传统模型，其特征在于<strong>它不依赖资源管理器(RM)对分布式事务的⽀持，⽽是通过对业务逻辑的分解来实现分布式事务</strong>。
TCC 模型认为对于业务系统中⼀个特定的业务逻辑，其对外提供服务时，必须接受⼀些不确定性，即对业务逻辑初步操作的调⽤仅是⼀个临时性操作，调⽤它的主业务服务保留了后续的取消权。如果主业务服务认为全局事务应该回滚，它会要求取消之前的临时性操作，这就对应从业务服务的取消操作。⽽当主业务服务认为全局事务应该提交时，它会放弃之前临时性操作的取消权，这对应从业务服务的确认操作。每⼀个初步操作，最终都会被确认或取消。
<strong>TCC 分布式事务模型包括三部分：</strong>
<a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/c56b5eb8a994f24bcb90384017f12915.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><p><strong>Try 阶段</strong>： 调⽤ Try 接⼝，尝试执⾏业务，完成所有业务检查，预留业务资源。
<strong>Confirm 或 Cancel 阶段</strong>： 两者是互斥的，只能进⼊其中⼀个，并且都满⾜幂等性，允许失败重试。
<strong>Confirm 操作</strong>： 对业务系统做确认提交，确认执⾏业务操作，不做其他业务检查，只使⽤ Try 阶段预留的业务资源。
<strong>Cancel 操作</strong>： 在业务执⾏错误，需要回滚的状态下执⾏业务取消，释放预留资源。</p><h4 id=try-阶段失败可以-cancel如果-confirm-和-cancel-阶段失败了怎么办>Try 阶段失败可以 Cancel，如果 Confirm 和 Cancel 阶段失败了怎么办？</h4><p>TCC 中会添加事务⽇志，如果 Confirm 或者 Cancel 阶段出错，则会进⾏重试，所以这两个阶段需要⽀持幂等；如果重试失败，则需要⼈⼯介⼊进⾏恢复和处理等。</p><h4 id=tcc事务模型的要求>TCC事务模型的要求</h4><ol><li>可查询操作：服务操作具有全局唯⼀的标识，操作唯⼀的确定的时间。</li><li>幂等操作：重复调⽤多次产⽣的业务结果与调⽤⼀次产⽣的结果相同。<ol><li>通过业务操作实现幂等性</li><li>系统缓存所有请求与处理的结果，最后是检测到重复请求之后，⾃动返回之前的处理结果。</li></ol></li></ol><h4 id=tcc事务模型-vs-dtp事务模型>TCC事务模型 VS DTP事务模型</h4><p>⽐较⼀下TCC事务模型和DTP事务模型，如下所示：</p><p><a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/d5fcc3e9308c4d25def48f3f5abc281e.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><p>这两张图看起来差别较⼤，实际上很多地⽅是类似的!</p><ol><li>TCC模型中的 主业务服务 相当于 DTP模型中的AP，TCC模型中的从业务服务 相当于 DTP模型中的RM</li></ol><p>在DTP模型中，应⽤AP操作多个资源管理器RM上的资源；⽽在TCC模型中，是主业务服务操作多个从业务服务上的资源。例如航班预定案例中，美团App就是主业务服务，⽽川航和东航就是从业务服务，主业务服务需要使⽤从业务服务上的机票资源。不同的是DTP模型中的资源提供者是类似于Mysql这种关系型数据库，⽽TCC模型中资源的提供者是其他业务服务。</p><ol start=2><li>TCC模型中，从业务服务提供的try、confirm、cancel接⼝ 相当于 DTP模型中RM提供的prepare、commit、rollback接⼝。XA协议中规定了DTP模型中定RM需要提供prepare、commit、rollback 接⼝给TM调⽤，以实现两阶段提交。⽽在TCC模型中，从业务服务相当于RM，提供了类似的try、confirm、 cancel接⼝。</li><li>事务管理器：DTP模型和TCC模型中都有⼀个事务管理器。不同的是：在DTP模型中，阶段1的(prepare)和阶段2的(commit、rollback)，都是由TM进⾏调⽤的。在TCC模型中，阶段1的try接⼝是主业务服务调⽤(绿⾊箭头)，阶段2的(confirm、cancel接⼝)是事务管理器TM调⽤(红⾊箭头)。这就是 TCC 分布式事务模型的⼆阶段异步化功能，从业务服务的第⼀阶段执⾏成功，主业务服务就可以提交完成，然后再由事务管理器框架异步的执⾏各从业务服务的第⼆阶段。这⾥牺牲了⼀定的隔离性和⼀致性的，但是提⾼了⻓事务的可⽤性。</li></ol><h4 id=tcc与2pc对>TCC与2PC对⽐</h4><p><a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/e2ccb3def111107d2fe1406275995bed.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p><ul><li>XA是资源层⾯的分布式事务，强⼀致性，在两阶段提交的整个过程中，⼀直会持有资源的锁。基于数据库锁实现，需要数据库⽀持XA协议，由于在执⾏事务的全程都需要对相关数据加锁，⼀般⾼并发性能会⽐较差</li><li>TCC是业务层⾯的分布式事务，最终⼀致性，不会⼀直持有资源的锁，性能较好。但是对微服务的侵⼊性强，微服务的每个事务都必须实现try、confirm、cancel等3个⽅法，开发成本⾼，今后维护改造的成本也⾼为了达到事务的⼀致性要求，try、confirm、cancel接⼝必须实现幂等性操作由于事务管理器要记录事务⽇志，必定会损耗⼀定的性能，并使得整个TCC事务时间拉⻓。TCC它会弱化每个步骤中对于资源的锁定，以达到⼀个能承受⾼并发的⽬的（基于最终⼀致性）。</li></ul><h4 id=tcc-的使场景>TCC 的使⽤场景</h4><p>TCC是可以解决部分场景下的分布式事务的，但是，它的⼀个问题在于，需要每个参与者都分别实现Try，Confirm和Cancel接⼝及逻辑，这对于业务的侵⼊性是巨⼤的。
TCC ⽅案严重依赖回滚和补偿代码，最终的结果是：回滚代码逻辑复杂，业务代码很难维护。所以，TCC ⽅案的使⽤场景较少，但是也有使⽤的场景。
⽐如说跟钱打交道的，⽀付、交易相关的场景，⼤家会⽤ TCC⽅案，严格保<strong>证分布式事务要么全部成功，要么全部⾃动回滚</strong>，严格保证资⾦的正确性，保证在资⾦上不会出现问题。</p><p><a class=lightgallery href=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg data-thumbnail=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg data-sub-html="<h2>https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg</h2>"><img loading=lazy src=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg srcset="https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg 1.5x, https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg 2x" sizes=auto data-title=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg data-alt=https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/2023/08/08/8c9efcd13d27e77e3dd521cc2566c192.jpeg style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2022-11-08 08:08:08">更新于 2022-11-08&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://leni.fun/distributed-transaction/ data-title="Distributed Transaction - 分布式事务"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/distributed/ class=post-tag>Distributed</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/netty_note/ class=post-nav-item rel=prev title="Netty 杂记"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Netty 杂记</a>
<a href=/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98/ class=post-nav-item rel=next title=多线程面试题>多线程面试题<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright order-5" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>都将会</a></span><span class="license footer-divider">后端开发工程师</span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor order-4"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/hihihiman/hihihiman.github.io title=博客源码 target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;bottom:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/pink/pace-theme-center-atom.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/typeit/index.umd.js defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:1024},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-header-subtitle-desktop":"的博客","typeit-header-subtitle-mobile":"的博客"},enablePWA:!0,lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,highlightTag:"em",ignoreFieldNorm:!0,ignoreLocation:!0,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,useExtendedSearch:!0},siteTime:"2021-08-26T23:31:00+08:00",typeit:{cursorChar:"_",cursorSpeed:1e3,data:{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},duration:-1,loop:!0,speed:100}}</script><script src=/js/theme.min.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>