# ðŸš©MicroService


### ä¸ºä»€ä¹ˆé€‰ç”¨ Consulï¼Ÿ

<!--more-->

- CPç³»ç»Ÿï¼š**å¼ºä¸€è‡´æ€§éœ€æ±‚**
- Go è¯­è¨€ç¼–å†™
- API æ–‡æ¡£ä¸°å¯Œï¼Œç¤¾åŒºæ´»è·ƒ
- æä¾›äº†ç®€æ˜“çš„äº‹åŠ¡èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨ Consul API æˆ– HTTP è¯·æ±‚å°†äº‹åŠ¡ä»£ç æäº¤ç»™ Consul Agent æ‰§è¡Œ
- **consul agent** ä¸ŽæœåŠ¡ä¹‹é—´æœ‰å¿ƒè·³æœºåˆ¶ï¼ŒåŸºäºŽ Gossip åè®®ï¼ŒåŽ»ä¸­å¿ƒåŒ–ï¼Œ**æ”¯æŒå¤šæ•°æ®ä¸­å¿ƒ**
- æä¾›**ä¸‰ç§æœåŠ¡å‘çŽ°æ–¹å¼**

- - DNSæœåŠ¡å‘çŽ°æ˜¯Consulæœ€åŽŸç”Ÿçš„æœåŠ¡å‘çŽ°æœºåˆ¶ï¼Œå®ƒé€šè¿‡å°†æœåŠ¡å®žä¾‹çš„IPåœ°å€æ³¨å†Œä¸ºDNSè®°å½•ï¼Œæ¥å®žçŽ°æœåŠ¡å‘çŽ°ã€‚
  - HTTP APIæœåŠ¡å‘çŽ°æ˜¯ä¸€ç§åŸºäºŽRESTful APIçš„æœåŠ¡å‘çŽ°æœºåˆ¶ï¼Œå®ƒé€šè¿‡HTTPè¯·æ±‚æ¥èŽ·å–æœåŠ¡å®žä¾‹çš„åœ°å€ä¿¡æ¯ã€‚
  - gRPCæœåŠ¡å‘çŽ°

- å®‰å…¨åŠŸèƒ½ï¼šTLS åŠ å¯†å’Œ ACLï¼ˆè®¿é—®æŽ§åˆ¶åˆ—è¡¨ï¼‰æœºåˆ¶ï¼Œå¯ä»¥å¯¹æœåŠ¡è¿›è¡Œæ›´ç»†ç²’åº¦çš„æƒé™æŽ§åˆ¶ã€‚

#### Consul > Eureka ï¼Ÿ

1. Consul - CPï¼ˆRaft åè®®ï¼‰ï¼ŒEureka - AP
2. Consul æ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼ŒEureka åªæ”¯æŒå•ä¸ªæ•°æ®ä¸­å¿ƒéƒ¨ç½²
3. Consul åœ¨æ¯ä¸ªæœåŠ¡å™¨ä¸Šéƒ½æœ‰ consul agentï¼Œæ•…éšœæ—¶é€šçŸ¥ leaderï¼›Eureka æ¯ 30s å¿ƒè·³æ£€æŸ¥ï¼Œå®žçŽ°ç®€å•
4. Consul ç”± Go ç¼–å†™ï¼Œå®‰è£…å¯åŠ¨å³å¯ï¼Œæä¾›äº†3ç§æœåŠ¡å‘çŽ°æœºåˆ¶ï¼ˆDNSã€HTTPã€gRPCï¼‰ï¼›Eureka æ˜¯ä¸ª servlet ç¨‹åºï¼Œè·‘åœ¨ servlet å®¹å™¨ä¸­ï¼ŒEureka åªæ”¯æŒåŸºäºŽ HTTP API çš„æœåŠ¡å‘çŽ°æœºåˆ¶ã€‚
5. Consul è¿˜æä¾›äº† ACLï¼ˆè®¿é—®æŽ§åˆ¶åˆ—è¡¨ï¼‰æœºåˆ¶ï¼Œå¯ä»¥å¯¹æœåŠ¡è¿›è¡Œæ›´ç»†ç²’åº¦çš„æƒé™æŽ§åˆ¶ã€‚

#### Consul > Zookeeper ï¼Ÿ

1. æ›´é€‚åˆæœåŠ¡å‘çŽ°ï¼šConsul æ˜¯ä¸“é—¨ä¸ºæœåŠ¡å‘çŽ°è€Œè®¾è®¡çš„ï¼Œè€Œ ZooKeeper åˆ™æ˜¯ä¸€ä¸ªé€šç”¨çš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡ã€‚Consul æä¾›äº†ä¸€äº›æ–¹ä¾¿çš„åŠŸèƒ½ï¼Œå¦‚å¥åº·æ£€æŸ¥ã€DNS è§£æžç­‰ï¼Œä½¿å¾—æœåŠ¡å‘çŽ°æ›´åŠ å®¹æ˜“ã€‚
2. æä¾›äº†åŽŸç”Ÿçš„åˆ†å¸ƒå¼é”ï¼ˆRaft åè®®ï¼‰ã€Leader é€‰ä¸¾æ”¯æŒ
3. Consul å¥åº·æ£€æŸ¥åŸºäºŽ Gossip åè®®ï¼ŒåŽ»ä¸­å¿ƒåŒ–ï¼Œæ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼Œï¼›zookeeper é‡‡ç”¨ä¸´æ—¶èŠ‚ç‚¹
4. Consul æä¾›äº†ç®€æ˜“çš„äº‹åŠ¡èƒ½åŠ›ï¼Œzookeeper åªæä¾›äº†ç‰ˆæœ¬å·æ£€æŸ¥èƒ½åŠ›
5. æ–‡æ¡£è¯¦å°½ã€ç¤¾åŒºæ´»è·ƒ

### å¾®æœåŠ¡æž¶æž„

- å•ä½“æž¶æž„ï¼šæ‰€æœ‰ä»£ç å…¨éƒ½åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæž¶æž„ç®€å•ã€éƒ¨ç½²æˆæœ¬ä½Žï¼Œä½†è€¦åˆåº¦é«˜
- åž‚ç›´æž¶æž„ï¼šMVCä¸‰å±‚ç»“æž„
- SOAæž¶æž„ï¼šService Oriented Architecture é¢å‘æœåŠ¡æž¶æž„ï¼Œå…³æ³¨ç‚¹æ˜¯æœåŠ¡ï¼ŒæœåŠ¡æ˜¯æœ€åŸºæœ¬çš„ä¸šåŠ¡åŠŸèƒ½å•å…ƒï¼Œç”±å¹³å°ä¸­ç«‹æ€§çš„æŽ¥å£å¥‘çº¦æ¥å®šä¹‰ã€‚
- å¾®æœåŠ¡æž¶æž„ï¼šæ¯ä¸ªå°å¾®æœåŠ¡éƒ½è¿è¡Œåœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼Œä¸€èˆ¬é‡‡ç”¨**HTTP**æ¥è½»é‡åŒ–é€šä¿¡ã€‚å•ä¸€èŒè´£ã€é¢å‘æœåŠ¡ã€è‡ªæ²»ï¼ˆå›¢é˜Ÿã€æŠ€æœ¯ã€æ•°æ®ã€éƒ¨ç½²éƒ½ç‹¬ç«‹ï¼‰ã€éš”ç¦»æ€§å¼º
- æœåŠ¡ç½‘æ ¼ï¼šæ˜¯ä¸€ç§å¾®æœåŠ¡æž¶æž„çš„æ‰©å±•ï¼Œæä¾›äº†æ›´åŠ ä¸°å¯Œçš„æœåŠ¡å‘çŽ°ã€è´Ÿè½½å‡è¡¡ã€æµé‡æŽ§åˆ¶ã€æ•…éšœæ¢å¤å’Œå®‰å…¨ç®¡ç†ç­‰åŠŸèƒ½ã€‚æœåŠ¡ç½‘æ ¼å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜æ›´åŠ è½»æ¾åœ°ç®¡ç†å’Œç›‘æŽ§å¾®æœåŠ¡æž¶æž„ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

### äº‘åŽŸç”Ÿ

äº‘åŽŸç”Ÿåº”ç”¨ç¨‹åºé€šå¸¸é‡‡ç”¨åˆ†å¸ƒå¼æž¶æž„ï¼Œå°†åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªå°åž‹æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½è¿è¡Œåœ¨ç‹¬ç«‹çš„å®¹å™¨ä¸­ï¼Œå¹¶é€šè¿‡è½»é‡çº§çš„é€šä¿¡æœºåˆ¶ç›¸äº’åä½œã€‚äº‘åŽŸç”Ÿåº”ç”¨ç¨‹åºçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

- å®¹å™¨åŒ–éƒ¨ç½²ï¼šåº”ç”¨ç¨‹åºä»¥å®¹å™¨çš„å½¢å¼è¿›è¡Œéƒ¨ç½²å’Œè¿è¡Œï¼Œå®¹å™¨å¯ä»¥å¿«é€Ÿå¯åŠ¨ã€åœæ­¢å’Œè¿ç§»ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºçš„å¯é æ€§å’Œå¯æ‰©å±•æ€§ã€‚
- å¾®æœåŠ¡æž¶æž„ï¼šåº”ç”¨ç¨‹åºé‡‡ç”¨å¾®æœåŠ¡æž¶æž„ï¼Œå°†åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªå°åž‹æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œå¼€å‘ã€éƒ¨ç½²å’Œæ‰©å±•ã€‚
- è‡ªåŠ¨åŒ–è¿ç»´ï¼šåº”ç”¨ç¨‹åºé‡‡ç”¨è‡ªåŠ¨åŒ–çš„éƒ¨ç½²ã€ç›‘æŽ§å’Œç®¡ç†å·¥å…·ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–åœ°è¿›è¡Œåº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€æ‰©å±•ã€å‡çº§å’Œæ•…éšœæ¢å¤ã€‚
- å¼¹æ€§è®¾è®¡ï¼šåº”ç”¨ç¨‹åºé‡‡ç”¨å¼¹æ€§è®¾è®¡ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ„ŸçŸ¥è´Ÿè½½å˜åŒ–å’Œæ•…éšœæƒ…å†µï¼Œå¹¶è‡ªåŠ¨è°ƒæ•´èµ„æºåˆ†é…ï¼Œä¿è¯åº”ç”¨ç¨‹åºçš„é«˜å¯ç”¨æ€§å’Œé«˜æ€§èƒ½ã€‚
- é¢å‘æœåŠ¡çš„æž¶æž„ï¼šåº”ç”¨ç¨‹åºé‡‡ç”¨é¢å‘æœåŠ¡çš„æž¶æž„ï¼Œå°†åº”ç”¨ç¨‹åºçš„æœåŠ¡ä½œä¸ºåŸºæœ¬çš„æž„å»ºå—ï¼Œé€šè¿‡æœåŠ¡é—´çš„åä½œæ¥å®žçŽ°åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚

#### å¾®æœåŠ¡æŠ€æœ¯æ ˆï¼šSpring Cloud + Consul + APISIX + Prometheus + Grafana + Hystrix

Spring Cloudå’ŒConsulç”¨äºŽæœåŠ¡æ³¨å†Œå’Œå‘çŽ°ï¼ŒAPISIXç”¨äºŽæœåŠ¡ç½‘å…³ï¼ŒPrometheuså’ŒGrafanaç”¨äºŽç›‘æŽ§å’Œå¯è§†åŒ–ï¼ŒHystrixç”¨äºŽæœåŠ¡ä¿æŠ¤å’Œå®¹é”™ã€‚è¿™äº›ç»„ä»¶éƒ½å¯ä»¥åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä¸€èµ·å·¥ä½œï¼Œäº’ç›¸åä½œï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å¾®æœåŠ¡æž¶æž„ã€‚

å…·ä½“æ¥è¯´ï¼ŒPrometheuså¯ä»¥é‡‡é›†Spring Cloudå’ŒAPISIXçš„æŒ‡æ ‡æ•°æ®ï¼ŒGrafanaå¯ä»¥å±•ç¤ºå’Œåˆ†æžè¿™äº›æ•°æ®ï¼ŒHystrixå¯ä»¥ä¿æŠ¤å’Œå®¹é”™æœåŠ¡ï¼ŒConsulå¯ä»¥ç”¨äºŽæœåŠ¡æ³¨å†Œå’Œå‘çŽ°ï¼ŒAPISIXå¯ä»¥ä½œä¸ºæœåŠ¡ç½‘å…³è¿›è¡Œè¯·æ±‚è·¯ç”±å’Œè´Ÿè½½å‡è¡¡ã€‚è¿™äº›ç»„ä»¶å¯ä»¥é€šè¿‡REST APIã€JMXã€Webhookç­‰æ–¹å¼ç›¸äº’äº¤äº’ã€‚

- REST APIï¼šREST APIæ˜¯ä¸€ç§åŸºäºŽHTTPåè®®çš„WebæœåŠ¡æ ‡å‡†ï¼Œç”¨äºŽä¸åŒåº”ç”¨ä¹‹é—´çš„æ•°æ®äº¤äº’å’Œè¿œç¨‹è°ƒç”¨ã€‚

- - APISIXå¯ä»¥é€šè¿‡REST APIä»ŽConsulä¸­èŽ·å–æœåŠ¡åˆ—è¡¨ï¼Œå¹¶è¿›è¡Œè´Ÿè½½å‡è¡¡å’Œè·¯ç”±ï¼ŒPrometheuså¯ä»¥é€šè¿‡REST APIä»ŽSpring Cloudå’ŒAPISIXä¸­èŽ·å–æŒ‡æ ‡æ•°æ®ï¼Œå¹¶å­˜å‚¨å’ŒæŸ¥è¯¢è¿™äº›æ•°æ®ã€‚

- JMXï¼šJMXæ˜¯Java Management Extensionsçš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§Javaå¹³å°çš„ç®¡ç†å’Œç›‘æŽ§æŠ€æœ¯ï¼Œç”¨äºŽåœ¨è¿è¡Œæ—¶ç®¡ç†å’Œç›‘æŽ§Javaåº”ç”¨ç¨‹åºã€‚

- - Hystrixå¯ä»¥é€šè¿‡JMXæš´éœ²æœåŠ¡ç†”æ–­å’Œé™çº§çš„çŠ¶æ€ï¼Œå¹¶æä¾›ç›‘æŽ§å’Œç®¡ç†APIï¼ŒPrometheuså¯ä»¥é€šè¿‡JMXæŠ“å–Hystrixçš„ç›‘æŽ§æ•°æ®ã€‚

- Webhookï¼šWebhookæ˜¯ä¸€ç§HTTPå›žè°ƒæœºåˆ¶ï¼Œç”¨äºŽåœ¨å‘ç”Ÿäº‹ä»¶æ—¶å‘æŒ‡å®šçš„URLå‘é€HTTPè¯·æ±‚ã€‚

- - Hystrixå¯ä»¥é€šè¿‡Webhookå‘å¤–éƒ¨ç³»ç»Ÿå‘é€è­¦æŠ¥å’Œé€šçŸ¥ï¼ŒPrometheuså¯ä»¥é€šè¿‡Webhookè§¦å‘å‘Šè­¦è§„åˆ™å¹¶å‘é€é€šçŸ¥ã€‚

### æœåŠ¡æ‹†åˆ†åŽŸåˆ™

1. ä¸åŒå¾®æœåŠ¡**å•ä¸€èŒè´£**ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡

1. 1. å‡è®¾æˆ‘ä»¬æ­£åœ¨æž„å»ºä¸€ä¸ªåœ¨çº¿å•†åŸŽç³»ç»Ÿï¼Œå¯ä»¥æ‹†åˆ†ä¸ºè®¢å•æœåŠ¡ã€æ”¯ä»˜æœåŠ¡ã€åº“å­˜æœåŠ¡å’Œç”¨æˆ·æœåŠ¡ç­‰å¾®æœåŠ¡

1. å¾®æœåŠ¡**æ•°æ®ç‹¬ç«‹**ï¼Œä¸è¦è®¿é—®å…¶ä»–å¾®æœåŠ¡çš„æ•°æ®åº“
2. å¾®æœåŠ¡å¯ä»¥**å°†ä¸šåŠ¡æš´éœ²ä¸ºæŽ¥å£**ï¼Œä¾›å…¶ä»–å¾®æœåŠ¡ä½¿ç”¨

### Eureka - æ³¨å†Œä¸­å¿ƒ

##### Q1ï¼šæ¶ˆè´¹è€…å¦‚ä½•èŽ·å–æœåŠ¡æä¾›è€…å…·ä½“ä¿¡æ¯ï¼Ÿ

- æœåŠ¡æä¾›è€…å¯åŠ¨æ—¶å‘ eureka **æ³¨å†Œ**è‡ªå·±çš„ä¿¡æ¯
- æ¶ˆè´¹è€…æ ¹æ®æœåŠ¡åç§°å‘ eureka **æ‹‰å–**æä¾›è€…ä¿¡æ¯

##### Q2ï¼šå¦‚æžœæœ‰å¤šä¸ªæœåŠ¡æä¾›è€…ï¼Œæ¶ˆè´¹è€…è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ

Aï¼šæœåŠ¡æ¶ˆè´¹è€…åˆ©ç”¨**è´Ÿè½½å‡è¡¡**ç®—æ³•ï¼Œä»ŽæœåŠ¡åˆ—è¡¨ä¸­æŒ‘é€‰ä¸€ä¸ª

##### Q3ï¼šæ¶ˆè´¹è€…å¦‚ä½•æ„ŸçŸ¥æœåŠ¡æä¾›è€…å¥åº·çŠ¶æ€ï¼Ÿ

Aï¼šæœåŠ¡æä¾›è€…æ¯éš” 30s å‘ EurekaServer å‘é€å¿ƒè·³è¯·æ±‚ï¼ŒæŠ¥å‘Šå¥åº·çŠ¶æ€ï¼Œ eureka ä¼šæ›´æ–°è®°å½•æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¿ƒè·³ä¸æ­£å¸¸ä¼šè¢«å‰”é™¤ã€‚

### Nacos vs Eureka ï¼Ÿ

1. æ¶ˆè´¹è€…ç«¯ï¼ŒNacos å¢žåŠ äº†æ³¨å†Œä¸­å¿ƒå‘ Consumer push æŽ¨é€å˜æ›´æ¶ˆæ¯
2. ä¸¤è€…é»˜è®¤AP ï¼Œ Nacos å¯é…ç½®ä¸´æ—¶å®žä¾‹`spring.cloud.nacos.discovery.ephemeral`ï¼Œå®žçŽ° CP 

1. 1. Nacos æœåŠ¡ç«¯ï¼šä¸´æ—¶å®žä¾‹é‡‡ç”¨**å¿ƒè·³ç›‘æµ‹**ï¼Œå¿ƒè·³ä¸æ­£å¸¸ä¼šè¢«å‰”é™¤ï¼›éžä¸´æ—¶å®žä¾‹ä¸»åŠ¨è¯¢é—®ï¼Œä¸ä¼šè¢«å‰”é™¤ã€‚ 

1. Eureka åªæœ‰æ³¨å†Œä¸­å¿ƒï¼ŒNacos è¿˜æœ‰é…ç½®ä¸­å¿ƒ

#### é…ç½®ä¸­å¿ƒ - çƒ­æ›´æ–°

1. åœ¨`@Value`æ³¨å…¥çš„å˜é‡æ‰€åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£` @RefreshScope  `
2. ä½¿ç”¨ `@ConfigurationProperties` æ³¨è§£

æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰é…ç½®éƒ½é€‚åˆæ”¾åˆ°é…ç½®ä¸­å¿ƒï¼Œå»ºè®®åªæ”¾ä¸€äº›éœ€è¦è¿è¡Œæ—¶è°ƒæ•´çš„å…³é”®å‚æ•°

### nginx åå‘ä»£ç† - æ­å»ºé›†ç¾¤

```nginx
http {
  upstream nacos-cluster {
      server 127.0.0.1:8845;
      server 127.0.0.1:8846;
      server 127.0.0.1:8847;
  }
Â·Â·Â·
}
```

### Ribbon - è´Ÿè½½å‡è¡¡

ç»™RestTemplateæ·»åŠ @LoadBalancedæ³¨è§£ï¼Œè´Ÿè½½å‡è¡¡åº•å±‚æµç¨‹ï¼š

1. è°ƒç”¨æŽ¥å£å‘èµ·è¯·æ±‚
2. RibbonLoadBalancerClient èŽ·å–urlä¸­çš„æœåŠ¡id
3. DynamicServerListLoadBalancer æ‹‰å– eureka-server ä¸­çš„æœåŠ¡åˆ—è¡¨
4. ðŸŒŸIRule æŽ¥å£å†³å®šè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¹¶é€‰æ‹©æŸä¸ªæœåŠ¡ï¼š 

1. 1. **ZoneAvoidanceRule**ï¼ˆé»˜è®¤ï¼‰ï¼šå¯¹ZoneåŒºåŸŸå†…å¤šä¸ªæœåŠ¡è½®è¯¢ï¼Œzoneå€¼å¯é…ç½®
   2. RoundRobinRuleï¼šè½®è¯¢
   3. WeightedResponseTimeRuleï¼šæœåŠ¡å“åº”æ—¶é—´è¶Šé•¿ï¼ŒæœåŠ¡å™¨æƒé‡å°±è¶Šå°ï¼Œæ¦‚çŽ‡å°±è¶Šä½Ž
   4. RandomRuleï¼šéšæœº

1. ä¿®æ”¹ urlï¼Œå‘èµ·è¯·æ±‚

#### å¤§è¯·æ±‚åœºæ™¯

Qï¼šæˆ‘ä»¬å…¬å¸ç”¨çš„æ˜¯è½®è¯¢æ¥ä½œä¸ºè´Ÿè½½å‡è¡¡ã€‚ä¸è¿‡å› ä¸ºè½®è¯¢æ²¡æœ‰å®žé™…æŸ¥è¯¢æœåŠ¡ç«¯èŠ‚ç‚¹çš„è´Ÿè½½ï¼Œæ‰€ä»¥éš¾å…ä¼šå‡ºçŽ°å¶å‘æ€§çš„è´Ÿè½½ä¸å‡è¡¡çš„é—®é¢˜ã€‚

A1ï¼šï¼ˆä¸šåŠ¡æ‹†åˆ†ï¼‰å‘è´¦æˆ·ä¸­å¿ƒæŸ¥è¯¢ loginName æ˜¯å¦å­˜åœ¨æ—¶ï¼Œä¼ çš„ list é™åˆ¶åœ¨ 100 ä»¥å†…ï¼Œé˜²æ­¢è¯·æ±‚è¿‡å¤§ã€‚

A2ï¼šï¼ˆéš”ç¦»è§’åº¦ï¼‰é­”æ”¹äº†ä¸€ä¸‹è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œè®©å¤§å®¢æˆ·è¢«æ‰“åˆ°å‡ ä¸ªä¸“é—¨çš„èŠ‚ç‚¹ä¸Š

#### åŠ æƒè´Ÿè½½å‡è¡¡çš„æƒé‡è®¾å®š

æƒé‡ä»£è¡¨èŠ‚ç‚¹çš„å¤„ç†èƒ½åŠ›ï¼ŒæˆåŠ è´¥å‡ï¼Œæƒé‡çš„è°ƒæ•´è¦è®¾ç½®å¥½ä¸Šé™å’Œä¸‹é™ã€‚

#### ä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡

æ¯”å¦‚è¯´é’ˆå¯¹ç”¨æˆ·çš„æœ¬åœ°ç¼“å­˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç”¨æˆ· ID æ¥è®¡ç®—å“ˆå¸Œå€¼ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®ä¿åŒä¸€ä¸ªç”¨æˆ·çš„æœ¬åœ°ç¼“å­˜å¿…ç„¶åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚ä¸è¿‡å³ä¾¿æ˜¯é‡‡ç”¨äº†ä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä¾æ—§ä¸èƒ½å½»åº•è§£å†³æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼ˆåº”ç”¨å‘å¸ƒæ—¶ï¼‰ã€‚

#### è´Ÿè½½å‡è¡¡ç­–ç•¥é…ç½®

åœ¨ consumer æ¶ˆè´¹è€…ç«¯ï¼š

1. é’ˆå¯¹**æ‰€æœ‰**æœåŠ¡æä¾›è€…ï¼šç›´æŽ¥**æ³¨å…¥IRuleç±»åž‹çš„Beané…ç½®ç­–ç•¥**
2. é’ˆå¯¹**ç‰¹å®š**æœåŠ¡æä¾›è€…ï¼šymlï¼š`userservice.ribbon.NFLoadBlancerRuleClassName: com.netflix.loadbalancer.RandomRule`

åŠ è½½ç­–ç•¥ï¼šé»˜è®¤æ‡’åŠ è½½ï¼Œé™¤éžé…ç½®ymlï¼š`ribbon.eager-load.enabled=true` å¼€å¯é¥¥é¥¿åŠ è½½



### Feign - è¿œç¨‹è°ƒç”¨

ç³»ç»Ÿçº§é…ç½®å†™å…¥ bootstrap.yml

#### åŸºæœ¬ä½¿ç”¨

1.  æ·»åŠ  pom ä¾èµ– 
2.  å¯åŠ¨ç±»æ·»åŠ ` @EnableFeignClients ` æ³¨è§£  
3.  å†™æŽ¥å£ï¼š 

```java
@FeignClient("userservice")
public interface UserClient{
  @GetMapping("/user/{id}")
  User findById(@PathVariable("id") Long id);
}
```

1.  ä½¿ç”¨ FeignClient ä¸­å®šä¹‰çš„æ–¹æ³•å–ä»£ RestTemplateï¼ˆå¹¶é›†æˆäº† ribbonï¼Œå®žçŽ°äº†è´Ÿè½½å‡è¡¡ï¼‰ 

#### è‡ªå®šä¹‰é…ç½®

-  ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼š`feign.Logger.Level`ï¼ŒåŒ…å« NONEã€BASICï¼ˆè®°å½•è¯·æ±‚åŸºæœ¬ä¿¡æ¯ï¼‰ã€HEADERSï¼ˆBASIC+è¯·æ±‚å¤´ï¼‰ã€FULLï¼ˆHEADERS+è¯·æ±‚ä½“ï¼‰ å››ç§çº§åˆ«ï¼ŒæŽ¨èä½¿ç”¨NONE æˆ–  **BASIC** 

1. 1.  é…ç½®æ–‡ä»¶æ–¹å¼ 
   2.  Java æ³¨è§£æ–¹å¼ 

- - -  é…ç½®ä¸€ä¸ª Logger.Level è¿™ä¸ª Bean 

```java
public class DefaultFeignConfiguration{
  @Bean
  public Logger.Level feignLogLevel(){
    return Logger.Level.BASIC;
  } 
}
```

- - -  å…¨å±€ï¼š@EnableFeignClientsï¼ˆdefaultConfiguration =  DefaultFeignConfiguration.class) 
    -  å±€éƒ¨ï¼š@EnableFeignClientsï¼ˆ**value="userservice"**, defaultConfiguration =  DefaultFeignConfiguration.class) 

-  å“åº”ç»“æžœè§£æžå™¨ï¼š`feign.codec.Decoder`ï¼ŒJson è½¬æ¢ä¸º POJO å¯¹è±¡ 
-  è¯·æ±‚å‚æ•°ç¼–ç ï¼š`feign.codec.Encoder`ï¼Œå¯¹è±¡è½¬æ¢ä¸º Json 
-  å¤±è´¥é‡è¯•æœºåˆ¶ï¼š`feign.Retryer`ï¼Œé»˜è®¤æ²¡æœ‰ï¼Œä¸è¿‡ä¼šä½¿ç”¨Ribbonçš„é‡è¯• 

#### æ€§èƒ½ä¼˜åŒ–

Feign åº•å±‚çš„å®¢æˆ·ç«¯å®žçŽ°ï¼š

- URLConnectionï¼šé»˜è®¤å®žçŽ°ï¼Œä¸æ”¯æŒè¿žæŽ¥æ± 
- Apache **HttpClientï¼šæ”¯æŒè¿žæŽ¥æ± **ï¼Œ`feign.httpclient.enabled=true`
- OKHttpï¼šæ”¯æŒè¿žæŽ¥æ± 

#### æœ€ä½³å®žè·µ

1. ç»§æ‰¿ï¼šç»™æ¶ˆè´¹è€…çš„ FeignClientå’Œæä¾›è€…çš„controllerå®šä¹‰**ç»Ÿä¸€çš„çˆ¶æŽ¥å£**ä½œä¸ºæ ‡å‡†ã€‚ 

1. 1. æœåŠ¡ã€ç´§è€¦åˆã€‘
   2. çˆ¶æŽ¥å£å‚æ•°åˆ—è¡¨ä¸­çš„æ˜ å°„ä¸ä¼šè¢«ç»§æ‰¿

1. âœ“æŠ½å–ï¼šå°† FeignClient æŠ½å–ä¸º**ç‹¬ç«‹æ¨¡å—**ï¼Œå¹¶æŠŠæŽ¥å£ç›¸å…³çš„POJOã€é»˜è®¤çš„Feigné…ç½®éƒ½æ”¾åˆ°è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæä¾›ç»™æ¶ˆè´¹è€…ç”¨ã€é™ä½Žè€¦åˆã€‘

#### Qï¼šå®šä¹‰çš„FeignClientä¸åœ¨SpringBootApplicationçš„æ‰«æåŒ…èŒƒå›´æ—¶ï¼ŒFeignClientæ— æ³•ä½¿ç”¨ï¼Ÿ

1. æŒ‡å®šFeignClientæ‰€åœ¨åŒ…ï¼š[@EnableFeignClients(basePackages ]() = "edu.zjut.feign.clients") 
2. æŒ‡å®šFeignClient**å­—èŠ‚ç **ï¼š[@EnableFeignClients(clients ]() = {UserClient.class}) ï¼ˆæŽ¨èï¼‰ 

### ç½‘å…³

#### åŠŸèƒ½

è¯·æ±‚å…ˆç»è¿‡ç½‘å…³ï¼Œå†è¿›å…¥å¾®æœåŠ¡ï¼š

1. èº«ä»½è®¤è¯å’Œæƒé™æ ¡éªŒ
2. æœåŠ¡è·¯ç”±ã€è´Ÿè½½å‡è¡¡
3. è¯·æ±‚é™æµ

#### ç½‘å…³æ¯”è¾ƒ

1. gatewayï¼šåŸºäºŽSpring5ä¸­æä¾›çš„WebFluxï¼Œå±žäºŽ**å“åº”å¼ç¼–ç¨‹**ï¼ˆæŽ¨èï¼‰
2. zuulï¼šåŸºäºŽ**Servlet**å®žçŽ°ï¼Œå±žäºŽ**é˜»å¡žå¼ç¼–ç¨‹**
3. Apisixï¼šNginx+etcdï¼Œæ€§èƒ½å¥½

1. 1. è¯·æ±‚è·¯ç”±å’Œè´Ÿè½½å‡è¡¡ï¼šAPISIXæ”¯æŒåŸºäºŽè¯·æ±‚å†…å®¹ã€è¯·æ±‚åœ°å€ã€è¯·æ±‚å¤´ç­‰å¤šç§æ–¹å¼è¿›è¡Œè¯·æ±‚è·¯ç”±ï¼Œå¹¶æä¾›å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢ã€åŠ æƒè½®è¯¢ã€éšæœºç­‰ã€‚
   2. æµé‡æŽ§åˆ¶å’Œé™æµï¼šAPISIXæ”¯æŒåŸºäºŽQPSã€è¿žæŽ¥æ•°ã€å¹¶å‘æ•°ç­‰å¤šç§æ–¹å¼è¿›è¡Œæµé‡æŽ§åˆ¶å’Œé™æµï¼Œå¯ä»¥ä¿æŠ¤åŽç«¯æœåŠ¡å…å—çªå‘æµé‡çš„å†²å‡»ã€‚
   3. è®¤è¯å’ŒæŽˆæƒï¼šAPISIXæ”¯æŒå¤šç§è®¤è¯å’ŒæŽˆæƒæ–¹å¼ï¼Œå¦‚åŸºäºŽJWTã€OAuth2ã€API Keyç­‰æ–¹å¼è¿›è¡Œè®¤è¯å’ŒæŽˆæƒï¼Œå¯ä»¥ä¿æŠ¤APIæœåŠ¡çš„å®‰å…¨æ€§ã€‚

### è·¨åŸŸé—®é¢˜

è·¨åŸŸï¼š**æµè§ˆå™¨**ç¦æ­¢è¯·æ±‚çš„å‘èµ·è€…ä¸ŽæœåŠ¡ç«¯å‘ç”Ÿè·¨åŸŸ**ajaxè¯·æ±‚**ï¼Œè¯·æ±‚è¢«æµè§ˆå™¨æ‹¦æˆªçš„é—®é¢˜ã€‚

- åŸŸåä¸åŒ
- åŸŸåç›¸åŒï¼Œç«¯å£ä¸åŒ

### åˆ†å¸ƒå¼æœåŠ¡åŒ–ä¸Ž SOA/ESB çš„åŒºåˆ«

1. æœ‰çŠ¶æ€éƒ¨åˆ†ï¼Œæ”¾åˆ°xxä¸­å¿ƒ

1. 1. é…ç½®ä¸­å¿ƒï¼šå…¨å±€éžä¸šåŠ¡å‚æ•°

1. 1. 1. Nacosï¼Œè¿è¡ŒæœŸæ”¹å˜é…ç½®ï¼Œé¿å…ä¸æ–­é‡å¯

1. 1. æ³¨å†Œä¸­å¿ƒï¼šè¿è¡ŒæœŸä¸´æ—¶çŠ¶æ€

1. 1. 1. ä¸»åŠ¨æŠ¥å‘Š+å¿ƒè·³ï¼šè®©æ¶ˆè´¹è€…èƒ½åŠ¨æ€çŸ¥é“ç”Ÿäº§è€…é›†ç¾¤çš„çŠ¶æ€å˜åŒ–

1. 1. å…ƒæ•°æ®ä¸­å¿ƒï¼šä¸šåŠ¡æ¨¡åž‹

1. 1. 1. å®šä¹‰äº†æ‰€æœ‰ä¸šåŠ¡æœåŠ¡çš„æ¨¡åž‹

1. æ— çŠ¶æ€éƒ¨åˆ†ï¼Œæ”¾åˆ°åº”ç”¨ä¾§ï¼ˆæ¡†æž¶å’Œé…ç½®éƒ¨åˆ†ï¼Œå°½é‡ä¸å½±å“ä¸šåŠ¡ä»£ç ï¼‰

### ç†”æ–­

ç›®çš„ï¼šç»™æœåŠ¡ç«¯æ¢å¤çš„æœºä¼šã€‚

ä½¿ç”¨ï¼šHystrix é‡‡ç”¨@EnableCircuitBreaker æ³¨è§£ï¼Œ10s å†…å¤±è´¥ 50%ä»¥ä¸Šè§¦å‘ç†”æ–­ï¼Œä¹‹åŽæ¯ 5s é‡è¯•ã€‚

- è®¾å®šåˆé€‚çš„é˜ˆå€¼â€”â€” å“åº”æ—¶é—´è¶…è¿‡ 1.2sï¼Œå¹¶ä¸”æŒç»­ 30s
- é˜²æ­¢æŠ–åŠ¨

æ€»çš„æ¥è¯´ï¼Œåœ¨ä»»ä½•çš„æ•…éšœå¤„ç†é‡Œé¢ï¼Œéƒ½è¦è€ƒè™‘æ¢å¤ç­–ç•¥ä¼šä¸ä¼šå¼•èµ·æŠ–åŠ¨é—®é¢˜ã€‚

- - è¶…è¿‡é˜ˆå€¼åŽï¼ŒæŒç»­ä¸€æ®µæ—¶é—´åŽå†ç†”æ–­
  - ç­‰å¾…ä¸€æ®µæ—¶é—´åŽï¼Œå†æ”¾å¼€æµé‡ï¼ˆæ ¹æ®ç»“æžœè°ƒæ•´è´Ÿè½½å‡è¡¡æƒé‡ï¼‰

åœºæ™¯ï¼šå½“ Redis å´©æºƒ or è¿”å›žæŸä¸ªé”™è¯¯ç±»åž‹æ—¶ï¼Œè§¦å‘ç†”æ–­ç­–ç•¥ï¼š

1. å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œè‡ªæ—‹åœ° ping Redisï¼Œç›´åˆ° Redis æ¢å¤ã€‚
2. å°†èŠ‚ç‚¹æŒªå‡ºè´Ÿè½½å‡è¡¡ç­–ç•¥çš„å¯ç”¨åˆ—è¡¨ï¼Œé™ä½Žæƒé‡ã€‚ä¸€æ®µæ—¶é—´åŽå¦‚æžœå®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸï¼Œå°±å¢žåŠ è°ƒæ•´è´Ÿè½½å‡è¡¡æƒé‡ï¼Œæµé‡å°±ä¼šå¢žåŠ ï¼Œå¦åˆ™è¯¥èŠ‚ç‚¹å°±ç»§ç»­ç­‰å¾…ã€‚
3. å½“æ‰€æœ‰èŠ‚ç‚¹éƒ½è§¦å‘ç†”æ–­äº†ï¼Œå°±é€šè¿‡é’‰é’‰/ä¼å¾®æœºå™¨äººå‘èµ·å‘Šè­¦é€šçŸ¥ï¼Œäººå·¥ä»‹å…¥å¤„ç†ã€‚

### é™çº§

è‡ªæˆ‘ä¿æŠ¤ï¼Œç›®çš„åœ¨äºŽåº”å¯¹ç³»ç»Ÿè‡ªèº«çš„æ•…éšœï¼Œä¸Ž feign æŽ¥å£æ•´åˆï¼Œç¼–å†™é™çº§é€»è¾‘ï¼ŒåŽ»æŽ‰ä¸å¿…è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œåªä¿ç•™æ ¸å¿ƒé€»è¾‘

e.g. ç¬¬ä¸€æ¬¡æŽ¥è§¦é™çº§ï¼šåŒåä¸€æ·˜å®æ— æ³•æŸ¥çœ‹å…¨éƒ¨è®¢å•ç­‰è¾¹ç¼˜ä¸šåŠ¡

åœºæ™¯ï¼š

1. è¯»å†™æœåŠ¡é™çº§å†™æœåŠ¡

1. 1. é™çº§ä¸é‡è¦çš„å†™æ•°æ®ï¼šåŸ‹ç‚¹æ•°æ®ã€è§‚æµ‹æ€§æ•°æ®
   2. ä»»åŠ¡æ¨¡å—ï¼Œä¸»æ’­è¯»æœåŠ¡å¤šï¼Œè¿è¥å•†å†™æœåŠ¡å¤šï¼Œåœ¨qpsè¿‡é«˜æ—¶ï¼Œé™çº§å†™æœåŠ¡ï¼Œé™çº§éžæ ¸å¿ƒæœåŠ¡ï¼ˆä¸èµšé’±çš„ï¼‰

1. å¿«æ…¢è·¯å¾„é™çº§æ…¢è·¯å¾„ï¼šç³»ç»Ÿçš„å¹¶å‘é«˜æ—¶ï¼Œå°†è¯·æ±‚æ ‡è®°ä¸ºé™çº§è¯·æ±‚ï¼ŒåªæŸ¥è¯¢ç¼“å­˜ï¼ˆå¿«è·¯å¾„ï¼‰ï¼Œä¸æŸ¥è¯¢æ•°æ®åº“ï¼ˆæ…¢è·¯å¾„ï¼‰ã€‚
2. æ°´å¹³åˆ†åº“ï¼šæœ€çƒ­çš„æ•°æ®æ”¾ç¼“å­˜ï¼Œæ¸©æ•°æ®æ”¾æ•°æ®åº“ï¼Œå†·æ•°æ®æ”¾ç¡¬ç›˜ï¼ˆä¸æä¾›å®žæ—¶æŸ¥è¯¢ï¼‰

### é™æµ

é›ªå´©ï¼šä¸€ä¸ªæœåŠ¡å¤±è´¥ï¼Œå¯¼è‡´æ•´æ¡é“¾è·¯éƒ½å¤±è´¥

é™æµå¯ä»¥è§£å†³å¼‚å¸¸çªå‘æµé‡ä½¿ç³»ç»Ÿé›ªå´©çš„é—®é¢˜ï¼Œæ–¹å¼ï¼š

- Tomcat æœ€å¤§è¿žæŽ¥æ•°
- Nginx æ¼æ¡¶ç®—æ³•
- ç½‘å…³ï¼šä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œå›ºå®šé€ŸçŽ‡ç”Ÿæˆä»¤ç‰Œï¼Œæ”¾å…¥æ¡¶ä¸­ï¼Œæ¯ä¸ªè¯·æ±‚æ‹¿åˆ°ä»¤ç‰Œæ‰ä¼šè¢«æ‰§è¡Œ

- - ç¡®å®šé˜ˆå€¼ï¼šçº¿ä¸Šé«˜å³°æœŸ QPSï¼Œå…¨é“¾è·¯åŽ‹æµ‹æµ‹é‡ç“¶é¢ˆï¼Œå¯åŠ¨æ€è°ƒæ•´

- - - å“åº”æ—¶é—´ - æ€§èƒ½
    - èµ„æºåˆ©ç”¨çŽ‡ - é«˜å¹¶å‘
    - åžåé‡

- è‡ªå®šä¹‰æ‹¦æˆªå™¨

#### IP é™æµ

èŽ·å–ç”¨æˆ·çœŸå®ž IPï¼š

1. åº”ç”¨å±‚æ–¹æ³•ï¼šX-Forwarded-Forï¼Œç¼ºç‚¹:ä¼šè¢«ä¼ªé€ ã€å¤šä¸ªX-Forwarded-Forå¤´éƒ¨ã€ä¸èƒ½è§£å†³HTTPå’ŒSMTPä¹‹å¤–çš„çœŸå®žæºIPèŽ·å–çš„éœ€æ±‚
2. ä¼ è¾“å±‚æ–¹æ³•ï¼šåˆ©ç”¨ TCP Options çš„å­—æ®µæ¥æ‰¿è½½çœŸå®žæº IP ä¿¡æ¯ã€Proxy Protocolã€NetScaler çš„ TCP IP header 
3. ç½‘ç»œå±‚ï¼šéš§é“ +DSR æ¨¡å¼

### éš”ç¦»

ç›®çš„ï¼šæå‡å¯ç”¨æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚

1. çº¿ç¨‹æ± éš”ç¦»å¿«æ…¢ä»»åŠ¡ï¼Œé˜²æ­¢å®šæ—¶ä»»åŠ¡ä¸èƒ½å¾—åˆ°åŠæ—¶çš„è°ƒåº¦ï¼Œä¸€ä¸ªä»»åŠ¡è¿è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼ï¼Œå°±è½¬äº¤ç»™æ…¢ä»»åŠ¡çº¿ç¨‹æ± ã€‚

1. 1. çº¿ç¨‹æ± åˆ†æˆä¸‰çº§ï¼šç‹¬äº«ï¼Œéƒ¨åˆ†å…±äº«ï¼Œå®Œå…¨å…±äº«ï¼Œå¹¶ä¸”è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚

1. æ•°æ®åº“æ°´å¹³åˆ†åº“ï¼šç´ æåº“å’Œå‘å¸ƒåº“åˆ†ç¦»ï¼Œåªæœ‰æ­£å¼å‘å¸ƒçš„æ—¶å€™ï¼Œç´ ææ‰åŒæ­¥åˆ°ç¼“å­˜ï¼Œæé«˜ç¼“å­˜å‘½ä¸­çŽ‡ã€‚
2. Redis éš”ç¦»ï¼šæ ¸å¿ƒä¸šåŠ¡ä¿è¯é«˜å¯ç”¨å¹¶ä¸” code reviewï¼Œéžæ ¸å¿ƒä¸šåŠ¡ å¯ä»¥å®¹é”™ï¼Œä»¥é˜²ç¼“å­˜å¤§é‡å¤§å¯¹è±¡å¯¼è‡´é›†ç¾¤è¶…æ—¶ã€å®•æœºã€‚
3. æœåŠ¡å…±äº«ä¸€éƒ¨åˆ†åŸºç¡€è®¾æ–½ï¼Œå¦‚éƒ¨ç½²ä¸¤å¥— Redis

### è¶…æ—¶æŽ§åˆ¶

ç›®çš„ï¼š

1. ç”¨æˆ·ä½“éªŒ e.g. é¦–é¡µæŽ¥å£é™åˆ¶åœ¨ 100ms å†…
2. åŠæ—¶é‡Šæ”¾èµ„æºã€‚

å¸¸ç”¨æŒ‡æ ‡ï¼š

- 99 çº¿ï¼š99%è¯·æ±‚éƒ½åœ¨é˜ˆå€¼å†…
- 999 çº¿ï¼š99.9%çš„è¯·æ±‚éƒ½åœ¨é˜ˆå€¼å†…

é“¾è·¯è¶…æ—¶æŽ§åˆ¶ï¼šå°†è¶…æ—¶æ—¶é—´æ”¾åœ¨åè®®å¤´ï¼ˆå¯ä»¥å­˜æ”¾å‰©ä½™è¶…æ—¶æ—¶é—´æˆ–è¶…æ—¶æ—¶é—´æˆ³ï¼‰



## Dubbo

### 1. Dubbo æ•´ä½“æž¶æž„



![img](https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/image-20220217154504733.png)



1. config é…ç½®å±‚ï¼šå¯¹å¤–é…ç½®æŽ¥å£ï¼Œä»¥ ServiceConfigã€ReferenceConfig ä¸ºä¸­å¿ƒ
2. proxy æœåŠ¡ä»£ç†å±‚ï¼šæœåŠ¡æŽ¥å£é€æ˜Žä»£ç†ï¼Œç”ŸæˆæœåŠ¡çš„å®¢æˆ·ç«¯ Stub å’ŒæœåŠ¡ç«¯ Skeletonï¼Œæ‰©å±•æŽ¥å£ä¸º ProxyFactory
3. registry æ³¨å†Œä¸­å¿ƒå±‚ï¼šå°è£…æœåŠ¡åœ°å€çš„æ³¨å†Œä¸Žå‘çŽ°ï¼Œä»¥æœåŠ¡ URL ä¸ºä¸­å¿ƒ
4. cluster è·¯ç”±å±‚ï¼šå°è£…å¤šä¸ªæä¾›è€…çš„è·¯ç”±åŠè´Ÿè½½å‡è¡¡ï¼Œå¹¶æ¡¥æŽ¥æ³¨å†Œä¸­å¿ƒï¼Œä»¥ Invoker ä¸ºä¸­å¿ƒ
5. monitor ç›‘æŽ§å±‚ï¼šRPCè°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ç›‘æŽ§
6. Protocol è¿œç¨‹è°ƒç”¨å±‚ï¼šå°è£… RPC è°ƒç”¨ï¼Œä»¥ Result ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æŽ¥å£ä¸º Protocolï¼ŒInvoker
7. exchange ä¿¡æ¯äº¤æ¢å±‚ï¼šå°è£…è¯·æ±‚å“åº”æ¨¡å¼ï¼ŒåŒæ­¥è½¬å¼‚æ­¥ï¼Œä»¥ Requestï¼ŒResponse ä¸ºä¸­å¿ƒ
8. transport ç½‘ç»œä¼ è¾“å±‚ï¼šæŠ½è±¡ mina å’Œ netty ä¸ºç»Ÿä¸€æŽ¥å£ï¼Œä»¥ Message ä¸ºä¸­å¿ƒ
9. serialize æ•°æ®åºåˆ—åŒ–å±‚ï¼šå¯å¤ç”¨çš„ä¸€äº›å·¥å…·ï¼Œæ‰©å±•æŽ¥å£ä¸º ThreadPool

## 2. åº”ç”¨åœºæ™¯

1. åˆ†å¸ƒå¼æœåŠ¡åŒ–æ”¹é€ ï¼šåž‚ç›´æ‹†åˆ†
2. å¼€æ”¾å¹³å°ï¼šå¼€æ”¾æ¨¡å¼ã€å®¹å™¨æ¨¡å¼
3. ç›´æŽ¥ä½œä¸ºå‰ç«¯ä½¿ç”¨çš„åŽç«¯ï¼ˆBFFï¼ŒBackend For Frontendï¼‰ï¼Œä¸€èˆ¬ä¸å»ºè®®
4. é€šè¿‡æœåŠ¡åŒ–å»ºè®¾ä¸­å°ï¼šåŸºäºŽDubboå®žçŽ°ä¸šåŠ¡ä¸­å°

Qï¼šæœåŠ¡å¦‚ä½•æš´éœ²ï¼Ÿ

Aï¼šå…·ä½“æœåŠ¡ -> Invoker -> Exporter

### 3. å¦‚ä½•è®¾è®¡å¹‚ç­‰æŽ¥å£ï¼Ÿ

1. ç”¨ bitmap åŽ»é‡
2. ä¹è§‚é”æœºåˆ¶


---

> ä½œè€…: éƒ½å°†ä¼š  
> URL: https://leni.fun/microservice/  

