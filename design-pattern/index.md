# ğŸš©Design Pattern - è®¾è®¡æ¨¡å¼


<!--more-->

### Principle åŸåˆ™ x 6

1. Open Close å¼€é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆé€šè¿‡æ¥å£å’ŒæŠ½è±¡ç±»ï¼‰
2. Liskov Substitution é‡Œæ°ä»£æ¢ï¼šå­ç±»å¯æ›¿æ¢çˆ¶ç±»
3. Dependence Inversion ä¾èµ–å€’è½¬ï¼šé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œéå…·ä½“
4. Interface Segregation æ¥å£éš”ç¦»ï¼š å¤šä¸ªéš”ç¦»çš„æ¥å£ä¼˜äºå•ä¸ªæ¥å£ï¼Œä»¥è§£è€¦åˆ
5. Demeter è¿ªç±³ç‰¹ï¼šæœ€å°‘çŸ¥é“åŸåˆ™ï¼Œå®ä½“é—´å‡å°‘ç›¸äº’ä½œç”¨ï¼Œæ¨¡å—ç‹¬ç«‹
6. Composite Reuse åˆæˆå¤ç”¨ï¼šç”¨èšåˆï¼Œè€Œéç»§æ‰¿ã€‚

### Create åˆ›å»ºå‹ x 5
| **Singleton** | 6ç§ |
| --- | --- |
| Prototype | å…‹éš†å¤§å¯¹è±¡ |
| Builder | å†…éƒ¨ç»“æ„å¤æ‚ï¼Œå…³æ³¨é¡ºåº |
| Factory | æ—¥å¿—ã€æ•°æ®åº“ |
| Abstract Factory | å¤šä¸ªäº§å“æ—ï¼ˆæ¢çš®è‚¤ï¼‰ |

### Structure ç»“æ„å‹ x 7
| Adapter é€‚é…å™¨ | è¡¥æ•‘æªæ–½ |
| --- | --- |
| Bridge æ¡¥æ¥ | æ‰©å±•ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ |
| Composite ç»„åˆ | éƒ¨åˆ†-æ•´ä½“ |
| **Decorator è£…é¥°å™¨** | ä¸å¢åŠ å­ç±»æ¥æ‰©å±•ç±» |
| Facade å¤–è§‚ | éšè—ç³»ç»Ÿå¤æ‚æ€§ï¼Œè¿èƒŒå¼€é—­åŸåˆ™ |
| Flyweight äº«å…ƒ | ä¸å¯åˆ†è¾¨çš„å¤§é‡å¯¹è±¡ |
| Proxy ä»£ç† | åˆ›å»ºå…·æœ‰åŸå¯¹è±¡çš„æ–°å¯¹è±¡
å’Œé€‚é…å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šé€‚é…å™¨æ¨¡å¼ä¸»è¦æ”¹å˜æ‰€è€ƒè™‘å¯¹è±¡çš„æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼ä¸èƒ½æ”¹å˜æ‰€ä»£ç†ç±»çš„æ¥å£ã€‚ 2ã€å’Œè£…é¥°å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šè£…é¥°å™¨æ¨¡å¼ä¸ºäº†å¢å¼ºåŠŸèƒ½ï¼Œè€Œä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†åŠ ä»¥æ§åˆ¶ã€‚ |

### Behavior è¡Œä¸ºå‹ x 11
| Chain of Responsibility è´£ä»»é“¾ | å¤šä¸ªå¯¹è±¡åŒæ—¶å¤„ç†ä¸€ä¸ªè¯·æ±‚ |
| --- | --- |
| Command å‘½ä»¤ | å¯æ”¯æŒæ’¤é”€ã€æ¢å¤æ“ä½œ |
| Interpreter è§£é‡Šå™¨ | é«˜é¢‘ã€ç‰¹å®šç±»å‹çš„é—®é¢˜ |
| Iterator è¿­ä»£å™¨ | é¡ºåºè®¿é—®èšåˆå¯¹è±¡ |
| Mediator ä¸­ä»‹è€… | 1å¯¹nçš„ç½‘çŠ¶ç»“æ„->1å¯¹1çš„æ˜Ÿå½¢ç»“æ„ |
| Memento å¤‡å¿˜å½• | 
1. ä¸ºæ»¡è¶³è¿ªç±³ç‰¹åŸåˆ™ï¼Œéœ€è¦ä¸€ä¸ªç®¡ç†å¤‡å¿˜å½•çš„ç±»
2. åŸå‹æ¨¡å¼+å¤‡å¿˜å½•æ¨¡å¼ï¼Œå¯èŠ‚çº¦å†…å­˜
3. å¸¸ç”¨äºå®ç°æ’¤é”€å’Œé‡åšåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨äºå®ç°æ•°æ®å¿«ç…§ã€äº‹åŠ¡ç®¡ç†ç­‰åº”ç”¨åœºæ™¯
 |
    | Observer è§‚å¯Ÿè€… | æŸå¯¹è±¡é€šçŸ¥å…¶ä»–å¯¹è±¡ |
    | State çŠ¶æ€ | è¡Œä¸ºéšçŠ¶æ€è€Œæ”¹å˜ï¼Œæ›¿ä»£ if...else... è¯­å¥ |
    | Strategy ç­–ç•¥ | åŠ¨æ€åœ¨å¤šç§è¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§ |
    | Template æ¨¡æ¿ | æŠ½ç¦»é€šç”¨æ–¹æ³•ï¼ŒåŠ finalä¿®é¥° |
    | Visitor è®¿é—®è€… | è¿åè¿ªç±³ç‰¹ã€ä¾èµ–å€’è½¬åŸåˆ™
    SimpleFileVisitor |

### å·¥å‚ï¼ˆåˆ›å»ºï¼‰+ç­–ç•¥ï¼ˆè¡Œä¸ºï¼‰æ¨¡å¼
ä½¿ç”¨åœºæ™¯ï¼šå¤šç§æ–¹å¼ç™»å½•ã€å¤šç§ä»˜æ¬¾æ–¹å¼ã€é˜¶æ¢¯è®¡ç®—
```
types: # key:è¯·æ±‚å‚æ•°
	account: accountGranter # ç±»åé¦–å­—æ¯æ”¹å°å†™
	sms: smsGranter
	we_chat: weChatGranter
```
```java
@Component
public class WeChatGranter implements UserGranter{
    @Override
    public LoginResp login(LoginReq loginReq){
        // to do
        return new LoginResp();
    }
}
@Component
public class UserLoginFactory implements ApplicationContextAware{
	private static Map<String, UserGranter> granterPool = new ConcurrentHashMap<>();
    @Override
    public void setApplicationContext(ApplicationContext application){
        // è·å–å®¹å™¨ä¸­çš„ bean å¯¹è±¡
        loginTypeConfig.getTypes().forEach((k,v)->{
            granterPool.put(k,(UserGranter) application.getBean(b));
        });
    }
    // å¯¹å¤–å¼€æ”¾
    public UserGranter getGranter(String grantType){
        return granterPool.get(grantType); 
    }
}
```
### å•ç‚¹ç™»å½• SSO = Single Sign On
ä¸€æ¬¡ç™»å½•ï¼Œè®¿é—®æ‰€æœ‰ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚

1. é›†æˆè®¤è¯ä¸­å¿ƒåˆ°åº”ç”¨ç³»ç»Ÿä¸­ï¼Œå¦‚ spring-security-oauth2
2. åœ¨è®¤è¯ä¸­å¿ƒä¸­é…ç½®åº”ç”¨ç³»ç»Ÿçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬**åº”ç”¨åç§°ã€åŸŸåã€å›è°ƒåœ°å€**ï¼ŒåŒæ—¶ä¸ºç”¨æˆ·åˆ†é…å”¯ä¸€ id
3. é›†æˆè®¤è¯ä¸­å¿ƒæä¾›çš„ SDK æˆ–åº“
4. ç”¨æˆ·æœªç™»å½•æ—¶ï¼Œé‡å®šå‘ï¼ˆredirectï¼‰åˆ°è®¤è¯ä¸­å¿ƒè¿›è¡Œç™»å½•ï¼ŒéªŒè¯å®Œèº«ä»½é‡å®šå‘å›åº”ç”¨ç³»ç»Ÿï¼Œåœ¨ URL å‚æ•°ä¸­æºå¸¦ç”¨æˆ·çš„èº«ä»½æ ‡è¯†ç¬¦
5. è®°å½•ç”¨æˆ·ç™»å½•çŠ¶æ€äº Session ä¸­
### ç®¡é“+è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆChannel+Filterï¼‰
æ‰€æœ‰çš„å¤æ‚å¤„ç†ï¼Œéƒ½å¯ä»¥æŠ½è±¡ä¸ºç®¡é“+è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆChannel+Filterï¼‰ï¼Œç”¨äºæœåŠ¡çš„è¿‡æ»¤

- å®ç°é¢å¤–çš„å¢å¼ºå¤„ç†ï¼Œå¦‚AOP
- ä¸­æ–­å½“å‰å¤„ç†æµç¨‹ï¼Œè¿”å›ç‰¹å®šæ•°æ®


---

> ä½œè€…: éƒ½å°†ä¼š  
> URL: https://leni.fun/design-pattern/  

