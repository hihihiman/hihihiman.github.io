# ğŸš©MyBatis é¢è¯•é¢˜


### #{}å’Œ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ 

<!--more-->

#{}æ˜¯é¢„ç¼–è¯‘å¤„ç†ï¼Œ`${}`æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ã€‚ 
Mybatis åœ¨å¤„ç†#{}æ—¶ï¼Œä¼šå°† sql ä¸­çš„#{}æ›¿æ¢ä¸º?å·ï¼Œè°ƒç”¨ 
PreparedStatement çš„set æ–¹æ³•æ¥èµ‹å€¼ï¼› 
Mybatis åœ¨å¤„ç†${}æ—¶ï¼Œå°±æ˜¯æŠŠ${}æ›¿æ¢æˆå˜é‡çš„å€¼ã€‚ä½¿ç”¨#{}å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ SQL æ³¨å…¥ï¼Œæé«˜ç³»ç»Ÿå®‰å…¨æ€§ã€‚ 

#### ä½¿ç”¨ ${} çš„æƒ…å†µ

1. å½“sqlä¸­è¡¨åæ˜¯ä»å‚æ•°ä¸­å–çš„æƒ…å†µ
2. order byæ’åºè¯­å¥ä¸­ï¼Œå› ä¸ºorder by åè¾¹å¿…é¡»è·Ÿå­—æ®µåï¼Œè¿™ä¸ªå­—æ®µåä¸èƒ½å¸¦å¼•å·ï¼Œå¦‚æœå¸¦å¼•å·ä¼šè¢«è¯†åˆ«ä¼šå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å­—æ®µã€‚

![image.png](https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/1682660700954-676f648e-e5a5-459b-bdb8-717329e799d5-20230808150808442.png)

![image.png](https://publicpictures.oss-cn-hangzhou.aliyuncs.com/img/1682660744867-3de42071-1bfa-4f98-824f-5854928a0f3a.png)



### Mybatis æ˜¯å¦‚ä½•è¿›è¡Œåˆ†é¡µçš„ï¼Ÿåˆ†é¡µæ’ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ 
Mybatis ä½¿ç”¨ **RowBounds å¯¹è±¡**è¿›è¡Œåˆ†é¡µï¼Œå®ƒæ˜¯**é’ˆå¯¹ ResultSet ç»“æœé›†**æ‰§è¡Œçš„**å†…å­˜åˆ†é¡µ**ï¼Œè€Œéç‰©ç†åˆ†é¡µã€‚å¯ä»¥åœ¨ sql å†…ç›´æ¥ä¹¦å†™å¸¦æœ‰ç‰©ç†åˆ†é¡µçš„å‚æ•°æ¥å®Œæˆç‰©ç†åˆ†é¡µåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ†é¡µæ’ä»¶æ¥å®Œæˆç‰©ç†åˆ†é¡µã€‚ 
åˆ†é¡µæ’ä»¶çš„åŸºæœ¬åŸç†æ˜¯ä½¿ç”¨ Mybatis æä¾›çš„æ’ä»¶æ¥å£ï¼Œå®ç°è‡ªå®šä¹‰æ’ä»¶ï¼Œåœ¨æ’ä»¶çš„æ‹¦æˆªæ–¹æ³•å†…æ‹¦æˆªå¾…æ‰§è¡Œçš„ sqlï¼Œç„¶åé‡å†™ sqlï¼Œæ ¹æ® dialect æ–¹è¨€ï¼Œæ·»åŠ å¯¹åº”çš„ç‰©ç†åˆ†é¡µè¯­å¥å’Œç‰©ç†åˆ†é¡µå‚æ•°ã€‚ 

### Mybatis çš„ä¸€çº§ã€äºŒçº§ç¼“å­˜ï¼Ÿ
åŸºäº **PerpetualCache**ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ª HashMapã€‚

1. ä¸€çº§ç¼“å­˜ï¼ˆé»˜è®¤å¼€å¯ï¼‰: å­˜å‚¨ä½œç”¨åŸŸä¸º **Session**ï¼Œå½“ Session flush æˆ– close æ—¶æ¸…ç©º
2. äºŒçº§ç¼“å­˜ï¼ˆé»˜è®¤å…³é—­ï¼‰ï¼šå­˜å‚¨ä½œç”¨åŸŸä¸º** Mapper(Namespace)**
   1. **éœ€è¦å®ç° serializable æ¥å£**
   2. åªæœ‰**ä¼šè¯æäº¤æˆ–å…³é—­**åï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®æ‰ä¼šè½¬ç§»åˆ°äºŒçº§ç¼“å­˜ä¸­
3. C/U/D æ“ä½œåï¼Œè¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚ 

### MyBatis æ‰§è¡Œæµç¨‹ï¼Ÿ

1. è¯»å–é…ç½®æ–‡ä»¶
2. SqlSession**Factory**ï¼šå”¯ä¸€çš„**ä¼šè¯å·¥å‚**
3. SqlSessionï¼šå¤šä¸ªä¼šè¯
4. **Executorï¼šæ‰§è¡Œå™¨ï¼Œæ‰§è¡Œæ•°æ®åº“æ“ä½œå¹¶ç»´æŠ¤ç¼“å­˜**
5. MappedStatementï¼šæ˜¯ Executor æ¥å£ä¸­çš„å‚æ•°ï¼Œå°è£…äº†æ˜ å°„ä¿¡æ¯ï¼Œ**æ¥æ”¶å…¥å‚ï¼Œè¿”å›å‡ºå‚**

### MyBatis å¼€å¯å»¶è¿ŸåŠ è½½
lazyLoadingEnabled = trueï¼ˆé»˜è®¤falseï¼‰ï¼ŒåŸç†ï¼š

1. ä½¿ç”¨ **CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡**
2. è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œ**è¿›å…¥æ‹¦æˆªå™¨ invoke æ–¹æ³•ï¼Œè‹¥ç›®æ ‡æ–¹æ³•ä¸º nullï¼Œæ‰§è¡Œ SQL**
3. é‡æ–°è°ƒç”¨

### Java å¯¹è±¡ä¸ MySQL å¯¹è±¡å¦‚ä½•æ˜ å°„ï¼Ÿ
MyBatis é»˜è®¤ä½¿ç”¨ JDBC çš„é¢„ç¼–è¯‘è¯­å¥æ¥æ‰§è¡Œ SQL è¯­å¥ã€‚åœ¨å°† String ç±»å‹çš„å‚æ•°ä¼ é€’ç»™ SQL è¯­å¥æ—¶ï¼ŒMyBatis ä¼šè‡ªåŠ¨å°†å…¶è½¬æ¢ä¸º VARCHAR ç±»å‹ã€‚
#### è‡ªå®šä¹‰ç±»å‹è½¬æ¢ - å®ç° TypeHandler æ¥å£


---

> ä½œè€…: éƒ½å°†ä¼š  
> URL: https://leni.fun/mybatis/  

