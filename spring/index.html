<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>🚩Spring -</title><meta name=author content="都将会"><meta name=author-link content><meta name=description content="🌟AOP（Aspect Oriented Programming）面向切面编程"><meta name=keywords content="Spring,interview,面试"><meta itemprop=name content="🚩Spring"><meta itemprop=description content="🌟AOP（Aspect Oriented Programming）面向切面编程"><meta itemprop=datePublished content="2023-08-08T08:00:00+08:00"><meta itemprop=dateModified content="2023-08-08T08:00:00+08:00"><meta itemprop=wordCount content="5267"><meta itemprop=image content="https://leni.fun/images/avatar.jpg"><meta itemprop=keywords content="Spring,"><meta property="og:title" content="🚩Spring"><meta property="og:description" content="🌟AOP（Aspect Oriented Programming）面向切面编程"><meta property="og:type" content="article"><meta property="og:url" content="https://leni.fun/spring/"><meta property="og:image" content="https://leni.fun/images/avatar.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-08T08:00:00+08:00"><meta property="article:modified_time" content="2023-08-08T08:00:00+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://leni.fun/images/avatar.jpg"><meta name=twitter:title content="🚩Spring"><meta name=twitter:description content="🌟AOP（Aspect Oriented Programming）面向切面编程"><meta name=application-name content="都将会的 APP"><meta name=apple-mobile-web-app-title content="都将会的 APP"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://leni.fun/spring/><link rel=prev href=https://leni.fun/mysql_draft/><link rel=next href=https://leni.fun/springboot_draft/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"🚩Spring","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/leni.fun\/spring\/"},"genre":"posts","keywords":"Spring","wordcount":5267,"url":"https:\/\/leni.fun\/spring\/","datePublished":"2023-08-08T08:00:00+08:00","dateModified":"2023-08-08T08:00:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"都将会"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title><img loading=lazy src=/images/icon.png srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x" sizes=auto data-title=/images/icon.png data-alt=/images/icon.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>都将会</span></a><span id=typeit-header-subtitle-desktop class="typeit header-subtitle"></span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 技术</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/life/><i class="fa-solid fa-camera-alt fa-fw fa-sm" aria-hidden=true></i> 生活</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=关键词搜索 id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title><img loading=lazy src=/images/icon.png srcset="/images/icon.png, /images/icon.png 1.5x, /images/icon.png 2x" sizes=auto data-title=/images/icon.png data-alt=/images/icon.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>都将会</span></a><span id=typeit-header-subtitle-mobile class="typeit header-subtitle"></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=关键词搜索 id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 技术</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/life/><i class="fa-solid fa-camera-alt fa-fw fa-sm" aria-hidden=true></i> 生活</a></li><li class=menu-item><a class=menu-link href=/friends/><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/ title>主页</a></li><li class=breadcrumb-item><a href=/posts/ title=Posts>Posts</a></li><li class="breadcrumb-item active" aria-current=page>🚩Spring</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>🚩Spring</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/images/avatar.jpg srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes=auto data-title=都将会 data-alt=都将会 class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;都将会</span></span>
<span class=post-category>收录于 <a href=/categories/interview/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> interview</a></span></div><div class=post-meta-line><span title="发布于 2023-08-08 08:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2023-08-08>2023-08-08</time></span>&nbsp;<span title="更新于 2023-08-08 08:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2023-08-08>2023-08-08</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 5267 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 11 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=🚩Spring>
<i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#aopaspect-oriented-programming面向切面编程>🌟AOP（Aspect Oriented Programming）面向切面编程</a><ul><li><a href=#aop-基本概念>AOP 基本概念</a></li><li><a href=#aop-工作流程>AOP 工作流程</a></li><li><a href=#切入点表达式>切入点表达式</a></li></ul></li><li><a href=#什么是动态代理>什么是动态代理？</a></li><li><a href=#spring-事务>Spring 事务</a><ul><li><a href=#事务失效场景>事务失效场景</a></li></ul></li><li><a href=#循环依赖如何解决三级缓存-or-lazy>循环依赖如何解决？三级缓存 or @lazy</a></li><li><a href=#spring-cloud-是如何调用的>Spring Cloud 是如何调用的？</a></li><li><a href=#springmvc-执行流程>SpringMVC 执行流程？</a></li><li><a href=#jwt>JWT</a><ul><li><a href=#jwt-数据结构>JWT 数据结构？</a></li><li><a href=#jwt-和-token-的区别>JWT 和 token 的区别？</a></li><li><a href=#security和jwt怎么融合>security和jwt怎么融合？</a></li><li><a href=#从cookie到jwt解决了什么>从cookie到jwt解决了什么？</a></li><li><a href=#token-泄露怎么处理>token 泄露怎么处理？</a></li></ul></li><li><a href=#springboot的自动装配原理>Springboot的自动装配原理？</a><ul><li><a href=#springbootapplication>@SpringbootApplication</a></li><li><a href=#注入方式>注入方式</a></li></ul></li><li><a href=#谈谈spring-bean的生命周期和作用域>谈谈Spring Bean的生命周期和作用域？</a><ul><li><a href=#生命周期>生命周期</a></li><li><a href=#五个作用域>五个作用域</a></li></ul></li><li><a href=#iocinversion-of-control控制反转>IoC（Inversion of Control）控制反转</a></li><li><a href=#q拦截器interceptor与过滤器filter的区别>Q：拦截器（Interceptor）与过滤器（Filter）的区别？</a><ul><li><a href=#执行流程>执行流程</a></li><li><a href=#拦截器interceptor>拦截器（Interceptor）</a></li><li><a href=#拦截器链>拦截器链</a></li></ul></li><li><a href=#全局异常处理>全局异常处理</a></li><li><a href=#rest风格representational-state-transfer表现形式状态转换>REST风格（Representational State Transfer）表现形式状态转换</a></li><li><a href=#q如何避免spring加载springmvc已加载的controller>Q：如何避免Spring加载SpringMVC已加载的Controller？</a></li><li><a href=#参数传递>参数传递</a></li><li><a href=#springmvc>SpringMVC</a></li><li><a href=#q如何保证无论转账是否成功都记录日志留痕>🌟Q：如何保证无论转账是否成功都记录日志留痕？</a></li></ul></li></ul></nav></div></div><div class=content id=content><h3 id=aopaspect-oriented-programming面向切面编程>🌟AOP（Aspect Oriented Programming）面向切面编程</h3><p>作用：在不惊动原始设计的基础上为其进行功能<strong>增强</strong>。（无侵入式）</p><h4 id=aop-基本概念>AOP 基本概念</h4><p>在 pom.xml 中导入 aspectjweaver ，配置 @EnableAspectJAutoProxy</p><ul><li>连接点（JoinPoint）：方法【可利用的机会】</li><li>切入点（PointCut）：是连接点的子集，要追加功能的方法 【解决了切面编程中的 Where 问题，让程序可以知道哪些机会点可以应用某个切面动作】<ul><li>[@Pointcut(&ldquo;execution(void ](/Pointcut() com.dao.xxxDao.update())&rdquo;) 修饰的方法 pt()</li></ul></li><li>通知（Advice）：有共性的功能 【明确了切面编程中的 What，也就是做什么；同时通过指定 Before、After 或者 Around，定义了 When，也就是什么时候做。】<ul><li>@Before(&ldquo;pt()&rdquo;)<ul><li>形参：JoinPoint</li></ul></li><li>@After(&ldquo;pt()&rdquo;)</li><li>@Around (&ldquo;pt()&rdquo;) public void around(<strong>ProceedingJoinPoint</strong> pjp) throws Throwable{ pjp.proceed();} （重点，常用）<ul><li>形参：ProceedingJoinPoint（必须放在参数的第一位）</li><li>要注意返回值和原始方法一致。</li><li>如果不执行pjp.proceed()，可以实现对原始方法的隔离（权限校验）</li></ul></li></ul></li></ul><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=nd>@Aspect</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ProjectAdvice</span><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nd>@Pointcut</span><span class=o>(</span><span class=s>&#34;execution(* com.edu.zjut.service.*Service.*(..))&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>private</span> <span class=kt>void</span> <span class=nf>servicePt</span><span class=o>(){}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nd>@Around</span><span class=o>(</span><span class=s>&#34;ProjectAdvice.servicePt()&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>runSpeed</span><span class=o>(</span><span class=n>ProceedingJoinPoint</span> <span class=n>pjp</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Throwable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Signature</span> <span class=n>signature</span> <span class=o>=</span> <span class=n>pjp</span><span class=o>.</span><span class=na>getSignature</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>className</span> <span class=o>=</span> <span class=n>signature</span><span class=o>.</span><span class=na>getDeclaringTypeNmae</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>methodName</span> <span class=o>=</span> <span class=n>signature</span><span class=o>.</span><span class=na>getName</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>start</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>currentTimeMillis</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>10000</span><span class=o>;</span><span class=n>i</span><span class=o>++){</span>
</span></span><span class=line><span class=cl>      <span class=n>pjp</span><span class=o>.</span><span class=na>proceed</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>end</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>currentTimeMillis</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;业务层接口万次执行&#34;</span><span class=o>+</span> <span class=n>className</span> <span class=o>+</span> <span class=s>&#34;.&#34;</span> <span class=o>+</span> <span class=n>methodName</span> <span class=o>+</span> <span class=s>&#34;------&gt;&#34;</span> <span class=o>+</span> <span class=o>(</span><span class=n>end</span><span class=o>-</span><span class=n>start</span><span class=o>)+</span><span class=s>&#34;ms&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><ul><li>AfterReturning(&ldquo;pt()&rdquo;) 只有不抛异常才运行</li><li>AfterThrowing(&ldquo;pt()")只有抛异常才运行</li><li>切面（Aspect）：通知和切入点的联系（多对多）</li><li>通知类：定义通知的类<ul><li><a href=/Aspect>@Aspect</a></li></ul></li></ul><h4 id=aop-工作流程>AOP 工作流程</h4><p>AOP的本质是<strong>代理模式</strong></p><ol><li>Spring容器启动</li><li>读取切面中配置的切入点</li><li>初始化bean，若类中方法匹配到切入点，则创建<strong>代理对象</strong></li><li>获取bean执行方法</li></ol><h4 id=切入点表达式>切入点表达式</h4><p>标准格式：<code>execution(返回值 包.类.接口（推荐）/实现类.方法())</code>
通配符：<code>*</code>匹配任意符号，<code>..匹配多个连续的任意符号，如：</code>execution(_ _..<em>Service+.</em>(..))`匹配业务层所有接口
书写技巧：</p><ol><li>所有类命名需规范，否则以下失效</li><li>描述切入点通常描述接口，而不描述实现类</li><li>增删改类使用精准类型加速匹配，查询类使用*通配快速描述</li><li>方法名以动词进行精准匹配</li><li>包名书写尽量不使用 .. 匹配，效率太低，常用 * 做单个包描述匹配</li><li>不使用异常作为匹配规则</li></ol><h3 id=什么是动态代理>什么是动态代理？</h3><p>动态代理是一种方便运行时动态构建代理、动态处理代理方法调用的机制，很多场景都是利用类似机制做到的，比如用来包装 RPC 调用、面向切面的编程（AOP），有两种实现：</p><ul><li><strong>JDK：实现接口</strong>，运用反射。如果目标对象实现了至少一个接口，Spring AOP将使用JDK动态代理来生成代理对象。代理对象实现了与目标对象相同的接口，并在方法调用前后织入切面逻辑。JDK动态代理是通过java.lang.reflect.Proxy类和java.lang.reflect.InvocationHandler接口实现的。</li><li><strong>cglib：修改字节码</strong>，生成子类。如果目标对象没有实现任何接口，Spring AOP将使用CGLIB库生成代理对象。CGLIB代理通过继承目标对象的子类来生成代理对象，然后在子类中织入切面逻辑。CGLIB代理可以处理没有接口的目标对象。<ul><li>基于 <strong>ASM，可以直接产生二进制 class 文件</strong>，也可以在类被加载入 Java 虚拟机之前动态改变类行为</li></ul></li></ul><h3 id=spring-事务>Spring 事务</h3><ul><li>编程式：TransactionTemplate 对业务有侵入性，少用。</li><li>声明式：@EnableTransactionManagement + @TranSactional<ul><li>通过 AOP 将事务处理的功能编织到拦截的方法中（方法前开启事务，方法后酌情回滚）</li></ul></li></ul><h4 id=事务失效场景>事务失效场景</h4><ol><li>异常捕获 => 在 catch 中 throw 异常</li><li>抛出检查异常 => 指定 rollbackfor，因为默认只回滚非检查异常</li><li>非 public 方法</li></ol><h3 id=循环依赖如何解决三级缓存-or-lazy>循环依赖如何解决？三级缓存 or @lazy</h3><p>三级缓存只能解决初始化过程中的循环依赖：</p><ul><li>一级 singletonObjects：单例池，存放已初始化完成的 bean</li><li>二级 earlySingletonObjects：存放生命周期未走完的 bean</li><li>三级 singletonFactories：对象工厂，用来创建对象</li></ul><p>对于构造方法中的循环依赖，采用 @lazy 进行懒加载</p><h3 id=spring-cloud-是如何调用的>Spring Cloud 是如何调用的？</h3><ol><li>RestTemplate方式调用</li><li>注入 RestTemplate 的bean，添加@Bean注解</li><li>调用 <code>.getForObject()</code> 或 <code>.postForObject()</code> 方法</li><li>Feign方式调用</li><li>添加 pom 依赖</li><li>启动类添加 <a href=/EnableFeignClients>@EnableFeignClients</a> 注解</li><li>写接口：</li></ol><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@FeignClient</span><span class=o>(</span><span class=s>&#34;userservice&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserClient</span><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nd>@GetMapping</span><span class=o>(</span><span class=s>&#34;/user/{id}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=n>User</span> <span class=nf>findById</span><span class=o>(</span><span class=nd>@PathVariable</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)</span> <span class=n>Long</span> <span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><ol start=4><li>使用 FeignClient 中定义的方法取代 RestTemplate（并集成了 ribbon，实现了负载均衡）
IRule 接口决定负载均衡策略，并选择某个服务：
1. <strong>ZoneAvoidanceRule</strong>（默认）：对Zone区域内多个服务轮询，zone值可配置
2. RoundRobinRule：轮询
3. WeightedResponseTimeRule：服务响应时间越长，服务器权重就越小，概率就越低
4. RandomRule：随机</li></ol><h3 id=springmvc-执行流程>SpringMVC 执行流程？</h3><p>与 DispatcherServlet（前端控制器） 依次交互的有：</p><ul><li>HandlerMapping （处理器映射器）：找到类名#方法名</li><li>HandlerAdaptor（适配器）：处理参数、返回值</li><li>ViewResolver（视图解析器，用于 JSP）：逻辑视图 -> 视图</li></ul><p>对于前后端分离项目，在方法上添加 @ResponseBody，通过 HttpMessageConverter 响应 JSON 数据
@RestController = @Controller + @ResponseBody</p><h3 id=jwt>JWT</h3><h4 id=jwt-数据结构>JWT 数据结构？</h4><ul><li>head</li><li>payload<ul><li>用户信息</li><li>加密信息</li><li>过期时间</li></ul></li><li>signature</li></ul><h4 id=jwt-和-token-的区别>JWT 和 token 的区别？</h4><p>token 需要查数据库，JWT 不需要。</p><h4 id=security和jwt怎么融合>security和jwt怎么融合？</h4><ul><li>认证：主要 jwt 的 token 实现</li><li>鉴权：springSecurity实现，RBAC = Role-Based Access Control</li></ul><h4 id=从cookie到jwt解决了什么>从cookie到jwt解决了什么？</h4><ol><li>可以转化为 json 串，可读性强；</li><li>RESTful 设计原则，避免在服务端保存会话状态，降低了服务器端的负担；</li><li>签名机制，安全性强。</li></ol><h4 id=token-泄露怎么处理>token 泄露怎么处理？</h4><p>采用非对称加密：给前端一个公钥，加密数据传到后台，用私钥解密后处理数据。</p><h3 id=springboot的自动装配原理>Springboot的自动装配原理？</h3><h4 id=springbootapplication>@SpringbootApplication</h4><ul><li>@SpringBootConfiguration 声明当前类为配置类</li><li>@ComponentScan 组件扫描</li><li>@EnableAutoConfiguration 自动化配置<ul><li>@Import 读取了项目和项目引用的 jar 包，位于 classpath 路径下 META-INF/spring.factories 文件</li><li>@ConditionalOnClass 有则加载</li></ul></li></ul><h4 id=注入方式>注入方式</h4><p>对于引用类型：</p><ol><li>按类型 byType（推荐）：<a href=/Autowired>**@Autowired **</a>** ** 使用的是暴力反射，不需要 setter方法</li><li>按名称 byName（变量名与配置耦合，不推荐）<ol><li><a href=/Autowired>@Autowired</a> + @Qualifier(&ldquo;beanName &ldquo;)</li><li>@Resource(&ldquo;名称&rdquo;)</li></ol></li><li>按构造方法（不常用）</li></ol><p>对于简单属性：使用 @Value(&ldquo;xxx&rdquo;)注入，可以来自外部 property，写法：<code>@Value("${name}")</code>
加载外部properties 使用 @PropertySource(&ldquo;classpath:jdbc.properties&rdquo;)，不可以使用星号<code>*</code></p><h3 id=谈谈spring-bean的生命周期和作用域>谈谈Spring Bean的生命周期和作用域？</h3><h4 id=生命周期>生命周期</h4><ol><li>实例化（Instantiation）：在这个阶段，Spring 会使用配置元数据（XML、注解或Java配置）来创建 Bean 的实例。这通常是通过调用构造函数来完成的。</li><li>属性赋值（Population）：在实例化之后，Spring 将会通过依赖注入（Dependency Injection）或属性赋值的方式来设置 Bean 的属性和依赖。这可以通过 setter 方法注入或使用字段注入来实现。</li><li>初始化（Initialization）：在属性赋值完成后，Spring 将会调用 Bean 的初始化回调方法（如果有的话）。开发者可以在 Bean 中定义初始化方法，使用 @PostConstruct 注解或实现 InitializingBean 接口来指定初始化逻辑。</li><li>使用（In Use）：在初始化完成后，Bean 可以被正常使用。此时，Bean 处于活动状态，可以被其他组件或者应用程序使用。</li><li>销毁（Destruction）：当应用程序关闭或者不再需要某个 Bean 时，Spring 会调用销毁回调方法来进行资源释放或清理操作。开发者可以在 Bean 中定义销毁方法，使用 @PreDestroy 注解或实现 DisposableBean 接口来指定销毁逻辑。</li></ol><p>使用模版方法设计模式实现：</p><ol><li>实例化 Bean：首先，Spring会实例化 Bean，即创建 Bean 的对象。</li><li>Aware接口回调：如果 Bean 实现了任何 Aware 接口（例如 BeanNameAware、BeanFactoryAware、ApplicationContextAware），在实例化之后但在属性赋值之前，Spring会调用相应的 Aware 接口回调方法，将相关的引用或资源传递给 Bean。</li><li>属性赋值：在 Aware 接口回调之后，Spring会进行属性赋值（依赖注入），将配置或注入的属性值设置到 Bean 中。</li><li>BeanPostProcessor前置处理：在属性赋值之后，Spring会调用所有注册的 BeanPostProcessor 的 postProcessBeforeInitialization 方法，允许开发者在 Bean 的初始化之前进行自定义处理。</li><li>初始化方法调用：如果 Bean 定义了初始化方法（例如通过 @PostConstruct 注解或实现 InitializingBean 接口），在前置处理之后，Spring会调用初始化方法。</li><li>BeanPostProcessor后置处理：在初始化方法调用之后，Spring会再次调用所有注册的 BeanPostProcessor 的 postProcessAfterInitialization 方法，允许开发者在 Bean 的初始化之后进行自定义处理。</li><li>Bean 可用：此时，Bean已经完成了初始化过程，可以正常使用。</li></ol><h4 id=五个作用域>五个作用域</h4><p>其中最基础的有下面两种：</p><ol><li>Singleton，这是 Spring 的默认作用域，也就是为每个 IOC 容器创建唯一的一个 Bean 实例。【适合无状态】</li><li>Prototype，针对每个 getBean 请求，容器都会单独创建一个 Bean 实例。【适合有状态】</li></ol><p>如果是 Web 容器：</p><ol><li>Request，为每个 HTTP 请求创建单独的 Bean 实例。</li><li>Session，很显然 Bean 实例的作用域是 Session 范围。</li><li>GlobalSession，用于 Portlet 容器，因为每个 Portlet 有单独的 Session，GlobalSession 提供一个全局性的 HTTP Session。</li></ol><h3 id=iocinversion-of-control控制反转>IoC（Inversion of Control）控制反转</h3><p>使用对象时，不再通过 new 产生对象，创建控制权由程序转移到<strong>外部</strong>的IoC容器（ApplicationContext，接口）
bean 之间的依赖注入方式</p><ol><li>setter注入（建议）：更加灵活，可以在对象创建以后动态更改依赖关系</li><li>构造方法注入：一旦创建完成，依赖关系就不能再改变</li></ol><h3 id=q拦截器interceptor与过滤器filter的区别>Q：拦截器（Interceptor）与过滤器（Filter）的区别？</h3><p>A：</p><ul><li>归属不同：Filter属于Servlet技术，Interceptor属于SpringMVC技术</li><li>拦截内容不同：Filter对所有访问进行增强，Interceptor仅针对SpringMVC的访问进行增强</li></ul><h4 id=执行流程>执行流程</h4><ol><li>preHandle（return true 才走下一步，false结束）</li><li>controller</li><li>postHandle</li><li>AfterCompletion</li></ol><h4 id=拦截器interceptor>拦截器（Interceptor）</h4><p>是一种动态拦截方法调用的机制，作用：</p><ol><li>在指定的方法调用前后执行预先设定的代码</li><li>组织原始方法的执行</li></ol><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// preHandle 方法中可以根据返回值决定是否继续执行方法
</span></span></span><span class=line><span class=cl><span class=c1>// 并且可以通过反射拿到拦截方法，进行更多操作
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>HandlerMethod</span> <span class=n>hm</span> <span class=o>=</span> <span class=o>(</span><span class=n>HandlerMethod</span><span class=o>)</span> <span class=n>handler</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>hm</span><span class=o>.</span><span class=na>getMethod</span><span class=o>();</span></span></span></code></pre></td></tr></table></div></div><h4 id=拦截器链>拦截器链</h4><p>preHandle在前的拦截器，postHandle 和 afterCompletion 在后。</p><ul><li>123 都为 true：pre 123 -> controller -> post 321 -> after 321</li><li>12 true 3 false：pre12 -> after 21</li><li>13 true 2 false： pre1 -> after 1</li><li>23 true 1 false：都不执行</li></ul><h3 id=全局异常处理>全局异常处理</h3><p>表现层通过AOP处理</p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestControllerAdvice</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GlobalExceptionHandler</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@ExceptionHandler</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>Exception</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>CommonResult</span> <span class=nf>handleUnknownException</span><span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CommonResult</span><span class=o>.</span><span class=na>failed</span><span class=o>(</span><span class=n>ResultCode</span><span class=o>.</span><span class=na>UNKN0OWN_FAILED</span><span class=o>,</span><span class=s>&#34;系统繁忙，请稍后再试！&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><ul><li>业务异常：提醒用户规范操作</li><li>系统异常：安抚用户，通知运维，记录日志</li></ul><h3 id=rest风格representational-state-transfer表现形式状态转换>REST风格（Representational State Transfer）表现形式状态转换</h3><p>资源名称采用复数，如users、books</p><ul><li>GET：查询</li><li>POST：新增</li><li>PUT：修改</li><li>DELETE：删除</li></ul><h3 id=q如何避免spring加载springmvc已加载的controller>Q：如何避免Spring加载SpringMVC已加载的Controller？</h3><p>A：加载Spring控制的bean的时候，排除掉SpringMVC控制的bean。</p><ol><li><code>@ComponentScan(value = "edu.zjut",excludeFilters=@ComponentScan.Filter(type=FilterType.ANNOTATION,classes=Controller.class))</code>按照注解排除</li><li><code>@ComponentScan({"edu.zjut.service","edu.zjut.dao"})</code></li><li>不区分Spring和SpringMVC的环境，都加载</li></ol><h3 id=参数传递>参数传递</h3><ul><li><p>@RequestParam(&ldquo;xxx&rdquo;)：请求参数和形参不同时需配置，不写的话默认取相同。</p></li><li><p><a href>@RequestParam</a> 修饰 List 就可以实现集合传参。</p></li><li><p>参数对象中有对象时采用 <code>address.city=beijing</code> 这种形式。</p></li><li><p>@RequestBody：设置controller方法返回值为响应体。传字符串（json）用</p></li><li><ul><li>HttpMessageConverter</li></ul></li><li><p>日期参数：接收可以用 Date 接，加上 <a href>@DateTimeFormat(pattern</a> = &ldquo;yyyy-MM-dd&rdquo;)</p></li><li><p><a href>@PathVariable</a> 从路径中取值</p></li></ul><h3 id=springmvc>SpringMVC</h3><p>基于 Java 实现 MVC 模型的轻量级 web 框架。</p><p>后端服务器：</p><ul><li><p>表现层：SpringMVC（取代 Servlet），封装数据（code、msg、data），用postman测试</p></li><li><p>业务层：Spring，用JUnit测试</p></li><li><ul><li>@RunWith(SpringJUnit4ClassRunner.class)</li><li><a href>@ContextConfiguration(classes</a> = SpringConfig.class)</li></ul></li><li><p>数据层：Mybatis</p></li></ul><p>返回 json 数据，需要加 <a href>@ResponseBody</a> 注解。</p><h3 id=q如何保证无论转账是否成功都记录日志留痕>🌟Q：如何保证无论转账是否成功都记录日志留痕？</h3><p>A：日志对应的事务不要加入转账的事务中，在插入日志的方法上加上 <code>@Transactional(propagation = Propagation.REQUIRES_NEW)</code></p><p>事务传播行为：作为协调员，</p><ul><li>REQUIRED（默认）：事务管理员有事务就加入，没事务就新建</li><li>REQUIRED_NEW：无论如何都新建事务</li><li>SUPPORTS：事务管理员有事务就加入，没有就算了</li><li>NOT_SUPPORTS：无乱如何都不支持事务</li><li>MANDATORY：事务管理员有事务就加入，没有就报错</li><li>NEVER：事务管理员没事务没关系，有事务就报错</li><li>NESTED：设置 savePoint</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2023-08-08 08:00:00">更新于 2023-08-08&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://leni.fun/spring/ data-title=🚩Spring><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/spring/ class=post-tag>Spring</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/mysql_draft/ class=post-nav-item rel=prev title="MySQL 杂记"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>MySQL 杂记</a>
<a href=/springboot_draft/ class=post-nav-item rel=next title="SpringBoot 杂记">SpringBoot 杂记<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/images/alipay.png srcset="/images/alipay.png, /images/alipay.png 1.5x, /images/alipay.png 2x" sizes=auto data-title="都将会 支付宝" data-alt="都将会 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span data-animation>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.jpg srcset="/images/wechatpay.jpg, /images/wechatpay.jpg 1.5x, /images/wechatpay.jpg 2x" sizes=auto data-title="都将会 微信" data-alt="都将会 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span data-animation>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright order-5" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>
<a href=/>都将会</a></span><span class="license footer-divider">后端开发工程师</span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor order-4"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/hihihiman/hihihiman.github.io title=博客源码 target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;bottom:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/pink/pace-theme-center-atom.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/instant-page/instantpage.min.js async defer type=module></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/typeit/index.umd.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:1024},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-header-subtitle-desktop":"的博客","typeit-header-subtitle-mobile":"的博客"},enablePWA:!0,pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!0,ignoreLocation:!0,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,type:"fuse",useExtendedSearch:!0},siteTime:"2023-08-06T23:31:00+08:00",typeit:{cursorChar:"_",cursorSpeed:1e3,data:{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},duration:-1,loop:!0,speed:100}}</script><script src=/js/theme.min.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>